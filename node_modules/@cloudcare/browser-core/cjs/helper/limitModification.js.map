{"version":3,"file":"limitModification.js","names":["_tools","require","_sanitize","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","length","i","F","s","n","done","value","e","_e","f","TypeError","normalCompletion","didErr","err","call","step","next","_e2","minLen","_arrayLikeToArray","Object","prototype","toString","slice","constructor","name","from","test","arr","len","arr2","limitModification","object","modifiableFieldPaths","modifier","clone","deepClone","result","each","objectEntries","filedPaths","fieldPath","fieldType","newValue","get","newType","getType","set","sanitize","path","current","_iterator","split","_step","field","isValidObjectContaining","fields","isValidObject","hasOwnProperty"],"sources":["../../src/helper/limitModification.js"],"sourcesContent":["import { extend2Lev, each, objectEntries, getType, deepClone } from './tools'\nimport { sanitize } from './sanitize'\n\n/**\n * Current limitation:\n * - field path do not support array, 'a.b.c' only\n */\nexport function limitModification(object, modifiableFieldPaths, modifier) {\n  var clone = deepClone(object)\n  var result = modifier(clone)\n  each(objectEntries(modifiableFieldPaths), function (filedPaths) {\n    var fieldPath = filedPaths[0]\n    var fieldType = filedPaths[1]\n    var newValue = get(clone, fieldPath)\n    var newType = getType(newValue)\n    if (newType === fieldType) {\n      set(object, fieldPath, sanitize(newValue))\n    } else if (\n      fieldType === 'object' &&\n      (newType === 'undefined' || newType === 'null')\n    ) {\n      set(object, fieldPath, {})\n    }\n  })\n\n  return result\n}\n\nfunction get(object, path) {\n  var current = object\n  for (var field of path.split('.')) {\n    if (!isValidObjectContaining(current, field)) {\n      return\n    }\n    current = current[field]\n  }\n  return current\n}\n\nfunction set(object, path, value) {\n  var current = object\n  var fields = path.split('.')\n  for (var i = 0; i < fields.length; i += 1) {\n    var field = fields[i]\n    if (!isValidObject(current)) {\n      return\n    }\n    if (i !== fields.length - 1) {\n      current = current[field]\n    } else {\n      current[field] = value\n    }\n  }\n}\n\nfunction isValidObject(object) {\n  return getType(object) === 'object'\n}\n\nfunction isValidObjectContaining(object, field) {\n  return (\n    isValidObject(object) && Object.prototype.hasOwnProperty.call(object, field)\n  )\n}\n"],"mappings":"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","ignoreList":[]}