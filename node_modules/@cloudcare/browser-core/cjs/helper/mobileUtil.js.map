{"version":3,"file":"mobileUtil.js","names":["userAgent","navigator","toLowerCase","exports","isAndroid","test","isIos","JsBirdge","bridge","window","tagMaps","mapWebViewCallBack","initBridge","err","prototype","_this","WVJBCallbacks","push","WVJBIframe","document","createElement","style","display","src","documentElement","appendChild","setTimeout","removeChild","sendEvent","params","callback","tag","Date","getTime","name","ret","Promise","resolve","callHandler","JSON","stringify","error","addEventListener"],"sources":["../../src/helper/mobileUtil.js"],"sourcesContent":["export var userAgent = navigator.userAgent.toLowerCase()\nexport var isAndroid = function () {\n  return /android/.test(userAgent)\n}\nexport var isIos = function () {\n  return /iphone os/.test(userAgent)\n}\n\nvar JsBirdge = function () {\n  this.bridge = window['FTWebViewJavascriptBridge']\n  this.tagMaps = {}\n  window.mapWebViewCallBack = {}\n  try {\n    this.initBridge()\n  } catch (err) {}\n}\nJsBirdge.prototype = {\n  initBridge: function () {\n    var _this = this\n    if (isIos()) {\n      if (!_this.bridge) {\n        if (window.WVJBCallbacks) {\n          window.WVJBCallbacks.push(function (bridge) {\n            _this.bridge = bridge\n          })\n          return\n        } else {\n          window.WVJBCallbacks = [\n            function (bridge) {\n              _this.bridge = bridge\n              return\n            }\n          ]\n          var WVJBIframe = document.createElement('iframe')\n          WVJBIframe.style.display = 'none'\n          WVJBIframe.src = 'wvjbscheme://__BRIDGE_LOADED__'\n          document.documentElement.appendChild(WVJBIframe)\n          setTimeout(function () {\n            document.documentElement.removeChild(WVJBIframe)\n          }, 0)\n        }\n      }\n    }\n  },\n  sendEvent: function (params, callback) {\n    if (typeof params === 'undefined') {\n      params = {}\n    }\n    var _this = this\n    var tag = 'Unique id:' + new Date().getTime()\n    if (params.name) {\n      _this.tagMaps[params.name] = tag\n      window.mapWebViewCallBack[tag] = function (ret, err) {\n        return Promise.resolve(ret, err)\n      }\n      params['_tag'] = tag\n      try {\n        if (isIos()) {\n          _this.bridge.callHandler(\n            'sendEvent',\n            JSON.stringify(params),\n            'mapWebViewCallBack'\n          )\n        } else {\n          _this.bridge.sendEvent(JSON.stringify(params), 'mapWebViewCallBack')\n        }\n      } catch (err) {}\n    } else {\n      callback({ error: '请传入发送事件的名称！！' })\n    }\n  },\n  addEventListener: function (params, callback) {\n    var tag = 'Unique id:' + new Date().getTime()\n    var _this = this\n    if (params.name) {\n      _this.tagMaps[params.name] = tag\n      window.mapWebViewCallBack[tag] = function (ret, err) {\n        callback(ret, err)\n        return\n      }\n      params['_tag'] = tag\n      try {\n        if (isIos()) {\n          _this.bridge.callHandler(\n            'addEventListener',\n            JSON.stringify(params),\n            'mapWebViewCallBack'\n          )\n        } else {\n          _this.bridge.addEventListener(\n            JSON.stringify(params),\n            'mapWebViewCallBack'\n          )\n        }\n      } catch (err) {}\n    } else {\n      callback({ error: '请传入监听事件的名称！！' })\n    }\n  }\n}\n\nexport var JsBirdge = JsBirdge\n"],"mappings":"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","ignoreList":[]}