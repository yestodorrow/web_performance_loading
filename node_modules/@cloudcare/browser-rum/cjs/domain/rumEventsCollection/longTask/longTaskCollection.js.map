{"version":3,"file":"longTaskCollection.js","names":["_browserCore","require","startLongTaskCollection","lifeCycle","sessionManager","subscribe","LifeCycleEventType","PERFORMANCE_ENTRIES_COLLECTED","entries","i","length","entry","entryType","session","findTrackedSession","startTime","startClocks","relativeToClocks","rawRumEvent","date","timeStamp","long_task","id","UUID","duration","toServerDuration","type","RumEventType","LONG_TASK","notify","RAW_RUM_EVENT_COLLECTED","relative","domainContext","performanceEntry","toJSON"],"sources":["../../../../src/domain/rumEventsCollection/longTask/longTaskCollection.js"],"sourcesContent":["import {\n  toServerDuration,\n  relativeToClocks,\n  RumEventType,\n  LifeCycleEventType,\n  UUID\n} from '@cloudcare/browser-core'\nexport function startLongTaskCollection(lifeCycle, sessionManager) {\n  lifeCycle.subscribe(\n    LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED,\n    function (entries) {\n      for (var i = 0; i < entries.length; i++) {\n        var entry = entries[i]\n        if (entry.entryType !== 'longtask') {\n          return\n        }\n        var session = sessionManager.findTrackedSession(entry.startTime)\n        if (!session) {\n          break\n        }\n\n        var startClocks = relativeToClocks(entry.startTime)\n        var rawRumEvent = {\n          date: startClocks.timeStamp,\n          long_task: {\n            id: UUID(),\n            duration: toServerDuration(entry.duration)\n          },\n          type: RumEventType.LONG_TASK\n        }\n        lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, {\n          rawRumEvent: rawRumEvent,\n          startTime: startClocks.relative,\n          domainContext: { performanceEntry: entry.toJSON() }\n        })\n      }\n    }\n  )\n}\n"],"mappings":";;;;;;AAAA,IAAAA,YAAA,GAAAC,OAAA;AAOO,SAASC,uBAAuBA,CAACC,SAAS,EAAEC,cAAc,EAAE;EACjED,SAAS,CAACE,SAAS,CACjBC,+BAAkB,CAACC,6BAA6B,EAChD,UAAUC,OAAO,EAAE;IACjB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,OAAO,CAACE,MAAM,EAAED,CAAC,EAAE,EAAE;MACvC,IAAIE,KAAK,GAAGH,OAAO,CAACC,CAAC,CAAC;MACtB,IAAIE,KAAK,CAACC,SAAS,KAAK,UAAU,EAAE;QAClC;MACF;MACA,IAAIC,OAAO,GAAGT,cAAc,CAACU,kBAAkB,CAACH,KAAK,CAACI,SAAS,CAAC;MAChE,IAAI,CAACF,OAAO,EAAE;QACZ;MACF;MAEA,IAAIG,WAAW,GAAG,IAAAC,6BAAgB,EAACN,KAAK,CAACI,SAAS,CAAC;MACnD,IAAIG,WAAW,GAAG;QAChBC,IAAI,EAAEH,WAAW,CAACI,SAAS;QAC3BC,SAAS,EAAE;UACTC,EAAE,EAAE,IAAAC,iBAAI,EAAC,CAAC;UACVC,QAAQ,EAAE,IAAAC,6BAAgB,EAACd,KAAK,CAACa,QAAQ;QAC3C,CAAC;QACDE,IAAI,EAAEC,yBAAY,CAACC;MACrB,CAAC;MACDzB,SAAS,CAAC0B,MAAM,CAACvB,+BAAkB,CAACwB,uBAAuB,EAAE;QAC3DZ,WAAW,EAAEA,WAAW;QACxBH,SAAS,EAAEC,WAAW,CAACe,QAAQ;QAC/BC,aAAa,EAAE;UAAEC,gBAAgB,EAAEtB,KAAK,CAACuB,MAAM,CAAC;QAAE;MACpD,CAAC,CAAC;IACJ;EACF,CACF,CAAC;AACH","ignoreList":[]}