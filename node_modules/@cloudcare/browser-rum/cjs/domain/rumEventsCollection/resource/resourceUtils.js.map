{"version":3,"file":"resourceUtils.js","names":["_browserCore","require","FAKE_INITIAL_DOCUMENT","exports","RESOURCE_TYPES","ResourceType","DOCUMENT","initiatorType","XHR","FETCH","BEACON","CSS","_","path","match","JS","IMAGE","includes","FONT","MEDIA","computeResourceKind","timing","url","name","isValidUrl","OTHER","getPathName","type","each","res","_type","isType","areInOrder","numbers","toArray","arguments","i","length","isRequestKind","HAS_MULTI_BYTES_CHARACTERS","getStrSize","candidate","test","window","TextEncoder","undefined","encode","Blob","size","isResourceUrlLimit","limitSize","computePerformanceResourceDuration","entry","duration","startTime","responseEnd","msToNs","is304","encodedBodySize","transferSize","isCacheHit","decodedBodySize","computePerformanceResourceDetails","validEntry","toValidEntry","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","details","firstbyte","trans","downloadTime","formatTiming","firstByteTime","preferredNow","ttfb","tcp","connectTime","ssl","sslTime","dns","dnsTime","hasRedirection","redirect","redirectTime","renderBlockingStatus","extend","origin","start","end","computeSize","isAllowedRequestUrl","configuration","isIntakeRequest","DATA_URL_REGEX","MAX_ATTRIBUTE_VALUE_CHAR_LENGTH","isLongDataUrl","substring","sanitizeDataUrl"],"sources":["../../../../src/domain/rumEventsCollection/resource/resourceUtils.js"],"sourcesContent":["import {\n  includes,\n  msToNs,\n  each,\n  toArray,\n  extend,\n  getPathName,\n  isValidUrl,\n  isIntakeRequest,\n  ResourceType,\n  preferredNow\n} from '@cloudcare/browser-core'\nexport var FAKE_INITIAL_DOCUMENT = 'initial_document'\n\nvar RESOURCE_TYPES = [\n  [\n    ResourceType.DOCUMENT,\n    function (initiatorType) {\n      return FAKE_INITIAL_DOCUMENT === initiatorType\n    }\n  ],\n  [\n    ResourceType.XHR,\n    function (initiatorType) {\n      return 'xmlhttprequest' === initiatorType\n    }\n  ],\n  [\n    ResourceType.FETCH,\n    function (initiatorType) {\n      return 'fetch' === initiatorType\n    }\n  ],\n  [\n    ResourceType.BEACON,\n    function (initiatorType) {\n      return 'beacon' === initiatorType\n    }\n  ],\n  [\n    ResourceType.CSS,\n    function (_, path) {\n      return path.match(/\\.css$/i) !== null\n    }\n  ],\n  [\n    ResourceType.JS,\n    function (_, path) {\n      return path.match(/\\.js$/i) !== null\n    }\n  ],\n  [\n    ResourceType.IMAGE,\n    function (initiatorType, path) {\n      return (\n        includes(['image', 'img', 'icon'], initiatorType) ||\n        path.match(/\\.(gif|jpg|jpeg|tiff|png|svg|ico)$/i) !== null\n      )\n    }\n  ],\n  [\n    ResourceType.FONT,\n    function (_, path) {\n      return path.match(/\\.(woff|eot|woff2|ttf)$/i) !== null\n    }\n  ],\n  [\n    ResourceType.MEDIA,\n    function (initiatorType, path) {\n      return (\n        includes(['audio', 'video'], initiatorType) ||\n        path.match(/\\.(mp3|mp4)$/i) !== null\n      )\n    }\n  ]\n]\n\nexport function computeResourceKind(timing) {\n  var url = timing.name\n  if (!isValidUrl(url)) {\n    return ResourceType.OTHER\n  }\n  var path = getPathName(url)\n  var type = ResourceType.OTHER\n  each(RESOURCE_TYPES, function (res) {\n    var _type = res[0],\n      isType = res[1]\n    if (isType(timing.initiatorType, path)) {\n      type = _type\n      return false\n    }\n  })\n  return type\n}\nfunction areInOrder() {\n  var numbers = toArray(arguments)\n  for (var i = 1; i < numbers.length; i += 1) {\n    if (numbers[i - 1] > numbers[i]) {\n      return false\n    }\n  }\n  return true\n}\n\nexport function isRequestKind(timing) {\n  return (\n    timing.initiatorType === 'xmlhttprequest' ||\n    timing.initiatorType === 'fetch'\n  )\n}\nvar HAS_MULTI_BYTES_CHARACTERS = /[^\\u0000-\\u007F]/\nexport function getStrSize(candidate) {\n  if (!HAS_MULTI_BYTES_CHARACTERS.test(candidate)) {\n    return candidate.length\n  }\n\n  if (window.TextEncoder !== undefined) {\n    return new TextEncoder().encode(candidate).length\n  }\n\n  return new Blob([candidate]).size\n}\nexport function isResourceUrlLimit(name, limitSize) {\n  return getStrSize(name) > limitSize\n}\nexport function computePerformanceResourceDuration(entry) {\n  // Safari duration is always 0 on timings blocked by cross origin policies.\n  if (entry.duration === 0 && entry.startTime < entry.responseEnd) {\n    return msToNs(entry.responseEnd - entry.startTime)\n  }\n\n  return msToNs(entry.duration)\n}\nexport function is304(entry) {\n  if (\n    entry.encodedBodySize > 0 &&\n    entry.transferSize > 0 &&\n    entry.transferSize < entry.encodedBodySize\n  ) {\n    return true\n  }\n\n  // unknown\n  return null\n}\nexport function isCacheHit(entry) {\n  // if we transferred bytes, it must not be a cache hit\n  // (will return false for 304 Not Modified)\n  if (entry.transferSize > 0) return false\n\n  // if the body size is non-zero, it must mean this is a\n  // ResourceTiming2 browser, this was same-origin or TAO,\n  // and transferSize was 0, so it was in the cache\n  if (entry.decodedBodySize > 0) return true\n\n  // fall back to duration checking (non-RT2 or cross-origin)\n  return entry.duration < 30\n}\n//  interface PerformanceResourceDetails {\n//   redirect?: PerformanceResourceDetailsElement\n//   dns?: PerformanceResourceDetailsElement\n//   connect?: PerformanceResourceDetailsElement\n//   ssl?: PerformanceResourceDetailsElement\n//   firstByte: PerformanceResourceDetailsElement\n//   download: PerformanceResourceDetailsElement\n//   fmp:\n// }\n// page_fmp\tfloat\t\t首屏时间(用于衡量用户什么时候看到页面的主要内容)，跟FCP的时长非常接近，这里我们就用FCP的时间作为首屏时间\tfirstPaintContentEnd - firstPaintContentStart\n// page_fpt\tfloat\t\t首次渲染时间，即白屏时间(从请求开始到浏览器开始解析第一批HTML文档字节的时间差。)\tresponseEnd - fetchStart\n// page_tti\tfloat\t\t首次可交互时间(浏览器完成所有HTML解析并且完成DOM构建，此时浏览器开始加载资源。)\tdomInteractive - fetchStart\n// page_firstbyte\tfloat\t\t首包时间\tresponseStart - domainLookupStart\n// page_dom_ready\tfloat\t\tDOM Ready时间(如果页面有同步执行的JS，则同步JS执行时间=ready-tti。)\tdomContentLoadEventEnd - fetchStart\n// page_load\tfloat\t\t页面完全加载时间(load=首次渲染时间+DOM解析耗时+同步JS执行+资源加载耗时。)\tloadEventStart - fetchStart\n// page_dns\tfloat\t\tdns解析时间\tdomainLookupEnd - domainLookupStart\n// page_tcp\tfloat\t\ttcp连接时间\tconnectEnd - connectStart\n// page_ssl\tfloat\t\tssl安全连接时间(仅适用于https)\tconnectEnd - secureConnectionStart\n// page_ttfb\tfloat\t\t请求响应耗时\tresponseStart - requestStart\n// page_trans\tfloat\t\t内容传输时间\tresponseEnd - responseStart\n// page_dom\tfloat\t\tDOM解析耗时\tdomInteractive - responseEnd\n// page_resource_load_time\tfloat\t\t资源加载时间\tloadEventStart - domContentLoadedEventEnd\n\n//  navigationStart：当前浏览器窗口的前一个网页关闭，发生unload事件时的Unix毫秒时间戳。如果没有前一个网页，则等于fetchStart属性。\n\n// ·   unloadEventStart：如果前一个网页与当前网页属于同一个域名，则返回前一个网页的unload事件发生时的Unix毫秒时间戳。如果没有前一个网页，或者之前的网页跳转不是在同一个域名内，则返回值为0。\n\n// ·   unloadEventEnd：如果前一个网页与当前网页属于同一个域名，则返回前一个网页unload事件的回调函数结束时的Unix毫秒时间戳。如果没有前一个网页，或者之前的网页跳转不是在同一个域名内，则返回值为0。\n\n// ·   redirectStart：返回第一个HTTP跳转开始时的Unix毫秒时间戳。如果没有跳转，或者不是同一个域名内部的跳转，则返回值为0。\n\n// ·   redirectEnd：返回最后一个HTTP跳转结束时（即跳转回应的最后一个字节接受完成时）的Unix毫秒时间戳。如果没有跳转，或者不是同一个域名内部的跳转，则返回值为0。\n\n// ·   fetchStart：返回浏览器准备使用HTTP请求读取文档时的Unix毫秒时间戳。该事件在网页查询本地缓存之前发生。\n\n// ·   domainLookupStart：返回域名查询开始时的Unix毫秒时间戳。如果使用持久连接，或者信息是从本地缓存获取的，则返回值等同于fetchStart属性的值。\n\n// ·   domainLookupEnd：返回域名查询结束时的Unix毫秒时间戳。如果使用持久连接，或者信息是从本地缓存获取的，则返回值等同于fetchStart属性的值。\n\n// ·   connectStart：返回HTTP请求开始向服务器发送时的Unix毫秒时间戳。如果使用持久连接（persistent connection），则返回值等同于fetchStart属性的值。\n\n// ·   connectEnd：返回浏览器与服务器之间的连接建立时的Unix毫秒时间戳。如果建立的是持久连接，则返回值等同于fetchStart属性的值。连接建立指的是所有握手和认证过程全部结束。\n\n// ·   secureConnectionStart：返回浏览器与服务器开始安全链接的握手时的Unix毫秒时间戳。如果当前网页不要求安全连接，则返回0。\n\n// ·   requestStart：返回浏览器向服务器发出HTTP请求时（或开始读取本地缓存时）的Unix毫秒时间戳。\n\n// ·   responseStart：返回浏览器从服务器收到（或从本地缓存读取）第一个字节时的Unix毫秒时间戳。\n\n// ·   responseEnd：返回浏览器从服务器收到（或从本地缓存读取）最后一个字节时（如果在此之前HTTP连接已经关闭，则返回关闭时）的Unix毫秒时间戳。\n\n// ·   domLoading：返回当前网页DOM结构开始解析时（即Document.readyState属性变为“loading”、相应的readystatechange事件触发时）的Unix毫秒时间戳。\n\n// ·   domInteractive：返回当前网页DOM结构结束解析、开始加载内嵌资源时（即Document.readyState属性变为“interactive”、相应的readystatechange事件触发时）的Unix毫秒时间戳。\n\n// ·   domContentLoadedEventStart：返回当前网页DOMContentLoaded事件发生时（即DOM结构解析完毕、所有脚本开始运行时）的Unix毫秒时间戳。\n\n// ·   domContentLoadedEventEnd：返回当前网页所有需要执行的脚本执行完成时的Unix毫秒时间戳。\n\n// ·   domComplete：返回当前网页DOM结构生成时（即Document.readyState属性变为“complete”，以及相应的readystatechange事件发生时）的Unix毫秒时间戳。\n\n// ·   loadEventStart：返回当前网页load事件的回调函数开始时的Unix毫秒时间戳。如果该事件还没有发生，返回0。\n\n// ·   loadEventEnd：返回当前网页load事件的回调函数运行结束时的Unix毫秒时间戳。如果该事件还没有发生，返回0\nexport function computePerformanceResourceDetails(entry) {\n  var validEntry = toValidEntry(entry)\n\n  if (!validEntry) {\n    return undefined\n  }\n\n  var startTime = validEntry.startTime,\n    fetchStart = validEntry.fetchStart,\n    redirectStart = validEntry.redirectStart,\n    redirectEnd = validEntry.redirectEnd,\n    domainLookupStart = validEntry.domainLookupStart,\n    domainLookupEnd = validEntry.domainLookupEnd,\n    connectStart = validEntry.connectStart,\n    secureConnectionStart = validEntry.secureConnectionStart,\n    connectEnd = validEntry.connectEnd,\n    requestStart = validEntry.requestStart,\n    responseStart = validEntry.responseStart,\n    responseEnd = validEntry.responseEnd\n  var details = {\n    firstbyte: msToNs(responseStart - domainLookupStart),\n    trans: msToNs(responseEnd - responseStart),\n    downloadTime: formatTiming(startTime, responseStart, responseEnd),\n    firstByteTime: formatTiming(startTime, requestStart, responseStart)\n  }\n  if (responseStart > 0 && responseStart <= preferredNow()) {\n    details.ttfb = msToNs(responseStart - requestStart)\n  }\n  // Make sure a connection occurred\n  if (connectEnd !== fetchStart) {\n    details.tcp = msToNs(connectEnd - connectStart)\n    details.connectTime = formatTiming(startTime, connectStart, connectEnd)\n    // Make sure a secure connection occurred\n    if (areInOrder(connectStart, secureConnectionStart, connectEnd)) {\n      details.ssl = msToNs(connectEnd - secureConnectionStart)\n      details.sslTime = formatTiming(\n        startTime,\n        secureConnectionStart,\n        connectEnd\n      )\n    }\n  }\n\n  // Make sure a domain lookup occurred\n  if (domainLookupEnd !== fetchStart) {\n    details.dns = msToNs(domainLookupEnd - domainLookupStart)\n    details.dnsTime = formatTiming(\n      startTime,\n      domainLookupStart,\n      domainLookupEnd\n    )\n  }\n\n  if (hasRedirection(entry)) {\n    details.redirect = msToNs(redirectEnd - redirectStart)\n    details.redirectTime = formatTiming(startTime, redirectStart, redirectEnd)\n  }\n  // renderBlockstatus\n  if (entry.renderBlockingStatus) {\n    details.renderBlockingStatus = entry.renderBlockingStatus\n  }\n  return details\n}\n\nexport function toValidEntry(entry) {\n  // Ensure timings are in the right order. On top of filtering out potential invalid\n  // RumPerformanceResourceTiming, it will ignore entries from requests where timings cannot be\n  // collected, for example cross origin requests without a \"Timing-Allow-Origin\" header allowing\n  // it.\n  // page_fmp\tfloat\t\t首屏时间(用于衡量用户什么时候看到页面的主要内容)，跟FCP的时长非常接近，这里我们就用FCP的时间作为首屏时间\tfirstPaintContentEnd - firstPaintContentStart\n  // page_fpt\tfloat\t\t首次渲染时间，即白屏时间(从请求开始到浏览器开始解析第一批HTML文档字节的时间差。)\tresponseEnd - fetchStart\n  // page_tti\tfloat\t\t首次可交互时间(浏览器完成所有HTML解析并且完成DOM构建，此时浏览器开始加载资源。)\tdomInteractive - fetchStart\n  // page_firstbyte\tfloat\t\t首包时间\tresponseStart - domainLookupStart\n  // page_dom_ready\tfloat\t\tDOM Ready时间(如果页面有同步执行的JS，则同步JS执行时间=ready-tti。)\tdomContentLoadEventEnd - fetchStart\n  // page_load\tfloat\t\t页面完全加载时间(load=首次渲染时间+DOM解析耗时+同步JS执行+资源加载耗时。)\tloadEventStart - fetchStart\n  // page_dns\tfloat\t\tdns解析时间\tdomainLookupEnd - domainLookupStart\n  // page_tcp\tfloat\t\ttcp连接时间\tconnectEnd - connectStart\n  // page_ssl\tfloat\t\tssl安全连接时间(仅适用于https)\tconnectEnd - secureConnectionStart\n  // page_ttfb\tfloat\t\t请求响应耗时\tresponseStart - requestStart\n  // page_trans\tfloat\t\t内容传输时间\tresponseEnd - responseStart\n  // page_dom\tfloat\t\tDOM解析耗时\tdomInteractive - responseEnd\n  // page_resource_load_time\tfloat\t\t资源加载时间\tloadEventStart - domContentLoadedEventEnd\n  if (\n    !areInOrder(\n      entry.startTime,\n      entry.fetchStart,\n      entry.domainLookupStart,\n      entry.domainLookupEnd,\n      entry.connectStart,\n      entry.connectEnd,\n      entry.requestStart,\n      entry.responseStart,\n      entry.responseEnd\n    )\n  ) {\n    return undefined\n  }\n\n  if (!hasRedirection(entry)) {\n    return entry\n  }\n\n  var redirectStart = entry.redirectStart\n  var redirectEnd = entry.redirectEnd\n  // Firefox doesn't provide redirect timings on cross origin requests.\n  // Provide a default for those.\n  if (redirectStart < entry.startTime) {\n    redirectStart = entry.startTime\n  }\n  if (redirectEnd < entry.startTime) {\n    redirectEnd = entry.fetchStart\n  }\n\n  // Make sure redirect timings are in order\n  if (\n    !areInOrder(entry.startTime, redirectStart, redirectEnd, entry.fetchStart)\n  ) {\n    return undefined\n  }\n  return extend({}, entry, {\n    redirectEnd: redirectEnd,\n    redirectStart: redirectStart\n  })\n  // return {\n  //   ...entry,\n  //   redirectEnd,\n  //   redirectStart\n  // }\n}\n\nfunction hasRedirection(entry) {\n  // The only time fetchStart is different than startTime is if a redirection occurred.\n  return entry.fetchStart !== entry.startTime\n}\n\nfunction formatTiming(origin, start, end) {\n  return {\n    duration: msToNs(end - start),\n    start: msToNs(start - origin)\n  }\n}\n\nexport function computeSize(entry) {\n  // Make sure a request actually occurred\n  if (entry.startTime < entry.responseStart) {\n    return {\n      size: entry.decodedBodySize,\n      encodedBodySize: entry.encodedBodySize,\n      decodedBodySize: entry.decodedBodySize,\n      transferSize: entry.transferSize\n    }\n    // return {\n    //   size: entry.decodedBodySize,\n    //   encodeSize:\n    //     Number.MAX_SAFE_INTEGER < entry.encodedBodySize\n    //       ? 0\n    //       : entry.encodedBodySize // max safe interger\n    // }\n  }\n  return {\n    size: undefined,\n    encodedBodySize: undefined,\n    decodedBodySize: undefined,\n    transferSize: undefined\n  }\n}\n\nexport function isAllowedRequestUrl(configuration, url) {\n  return url && !isIntakeRequest(url, configuration)\n}\n\nvar DATA_URL_REGEX = /data:(.+)?(;base64)?,/g\nexport var MAX_ATTRIBUTE_VALUE_CHAR_LENGTH = 24_000\nexport function isLongDataUrl(url) {\n  if (url.length <= MAX_ATTRIBUTE_VALUE_CHAR_LENGTH) {\n    return false\n  } else if (url.substring(0, 5) === 'data:') {\n    // Avoid String.match RangeError: Maximum call stack size exceeded\n    url = url.substring(0, MAX_ATTRIBUTE_VALUE_CHAR_LENGTH)\n    return true\n  }\n  return false\n}\n\nexport function sanitizeDataUrl(url) {\n  return url.match(DATA_URL_REGEX)[0] + '[...]'\n}\n"],"mappings":"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","ignoreList":[]}