{"version":3,"file":"trackFirstInput.js","names":["_browserCore","require","_getSelectorsFromElement","trackFirstInput","lifeCycle","configuration","firstHidden","callback","subscribe","LifeCycleEventType","PERFORMANCE_ENTRIES_COLLECTED","entries","firstInputEntry","find","entry","entryType","startTime","geTimeStamp","firstInputDelay","elapsed","processingStart","firstInputTargetSelector","target","isElementNode","getSelectorFromElement","actionNameAttribute","delay","time","targetSelector","stop","unsubscribe"],"sources":["../../../../src/domain/rumEventsCollection/view/trackFirstInput.js"],"sourcesContent":["import {\n  elapsed,\n  find,\n  LifeCycleEventType,\n  isElementNode\n} from '@cloudcare/browser-core'\nimport { getSelectorFromElement } from '../actions/getSelectorsFromElement'\n\n/**\n * Track the first input occurring during the initial View to return:\n * - First Input Delay\n * - First Input Time\n * Callback is called at most one time.\n * Documentation: https://web.dev/fid/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/getFID.ts\n */\nexport function trackFirstInput(\n  lifeCycle,\n  configuration,\n  firstHidden,\n  callback\n) {\n  var subscribe = lifeCycle.subscribe(\n    LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED,\n    function (entries) {\n      var firstInputEntry = find(entries, function (entry) {\n        return (\n          entry.entryType === 'first-input' &&\n          entry.startTime < firstHidden.geTimeStamp()\n        )\n      })\n      if (firstInputEntry) {\n        var firstInputDelay = elapsed(\n          firstInputEntry.startTime,\n          firstInputEntry.processingStart\n        )\n        var firstInputTargetSelector\n        if (firstInputEntry.target && isElementNode(firstInputEntry.target)) {\n          firstInputTargetSelector = getSelectorFromElement(\n            firstInputEntry.target,\n            configuration.actionNameAttribute\n          )\n        }\n        callback({\n          // Ensure firstInputDelay to be positive, see\n          // https://bugs.chromium.org/p/chromium/issues/detail?id=1185815\n          delay: firstInputDelay >= 0 ? firstInputDelay : 0,\n          time: firstInputEntry.startTime,\n          targetSelector: firstInputTargetSelector\n        })\n      }\n    }\n  )\n  return {\n    stop: subscribe.unsubscribe\n  }\n}\n"],"mappings":";;;;;;AAAA,IAAAA,YAAA,GAAAC,OAAA;AAMA,IAAAC,wBAAA,GAAAD,OAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASE,eAAeA,CAC7BC,SAAS,EACTC,aAAa,EACbC,WAAW,EACXC,QAAQ,EACR;EACA,IAAIC,SAAS,GAAGJ,SAAS,CAACI,SAAS,CACjCC,+BAAkB,CAACC,6BAA6B,EAChD,UAAUC,OAAO,EAAE;IACjB,IAAIC,eAAe,GAAG,IAAAC,iBAAI,EAACF,OAAO,EAAE,UAAUG,KAAK,EAAE;MACnD,OACEA,KAAK,CAACC,SAAS,KAAK,aAAa,IACjCD,KAAK,CAACE,SAAS,GAAGV,WAAW,CAACW,WAAW,CAAC,CAAC;IAE/C,CAAC,CAAC;IACF,IAAIL,eAAe,EAAE;MACnB,IAAIM,eAAe,GAAG,IAAAC,oBAAO,EAC3BP,eAAe,CAACI,SAAS,EACzBJ,eAAe,CAACQ,eAClB,CAAC;MACD,IAAIC,wBAAwB;MAC5B,IAAIT,eAAe,CAACU,MAAM,IAAI,IAAAC,0BAAa,EAACX,eAAe,CAACU,MAAM,CAAC,EAAE;QACnED,wBAAwB,GAAG,IAAAG,+CAAsB,EAC/CZ,eAAe,CAACU,MAAM,EACtBjB,aAAa,CAACoB,mBAChB,CAAC;MACH;MACAlB,QAAQ,CAAC;QACP;QACA;QACAmB,KAAK,EAAER,eAAe,IAAI,CAAC,GAAGA,eAAe,GAAG,CAAC;QACjDS,IAAI,EAAEf,eAAe,CAACI,SAAS;QAC/BY,cAAc,EAAEP;MAClB,CAAC,CAAC;IACJ;EACF,CACF,CAAC;EACD,OAAO;IACLQ,IAAI,EAAErB,SAAS,CAACsB;EAClB,CAAC;AACH","ignoreList":[]}