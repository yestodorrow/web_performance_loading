{"version":3,"file":"observers.js","names":["_browserCore","require","_initViewportObservable","_constants","_types","_privacy","_serializationUtils","_utils","_mutationObserver","_viewports","_eventTypeToMouseInte","_typeof","obj","Symbol","iterator","constructor","prototype","_defineProperty","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","toPrimitive","undefined","res","call","TypeError","Number","MOUSE_MOVE_OBSERVER_THRESHOLD","SCROLL_OBSERVER_THRESHOLD","VISUAL_VIEWPORT_OBSERVER_THRESHOLD","recordIds","WeakMap","nextId","getRecordIdForEvent","event","has","set","get","initObservers","o","mutationHandler","initMutationObserver","mutationCb","configuration","shadowRootsController","mousemoveHandler","initMoveObserver","mousemoveCb","mouseInteractionHandler","initMouseInteractionObserver","mouseInteractionCb","defaultPrivacyLevel","scrollHandler","initScrollObserver","scrollCb","elementsScrollPositions","viewportResizeHandler","initViewportResizeObserver","viewportResizeCb","inputHandler","initInputObserver","inputCb","mediaInteractionHandler","initMediaInteractionObserver","mediaInteractionCb","styleSheetObserver","initStyleSheetObserver","styleSheetCb","focusHandler","initFocusObserver","focusCb","visualViewportResizeHandler","initVisualViewportResizeObserver","visualViewportResizeCb","frustrationHandler","initFrustrationObserver","lifeCycle","frustrationCb","flush","stop","cb","startMutationObserver","document","_updatePosition","throttle","target","getEventTarget","hasSerializedNode","coordinates","tryToComputeCoordinates","position","id","getSerializedNodeId","timeOffset","x","y","isTouchEvent","IncrementalSource","TouchMove","MouseMove","trailing","cancelThrottle","cancel","updatePosition","throttled","_listener","addEventListeners","DOM_EVENT","MOUSE_MOVE","TOUCH_MOVE","capture","passive","removeListener","eventTypeToMouseInteraction","POINTER_UP","MouseInteractionType","MouseUp","MOUSE_DOWN","MouseDown","CLICK","Click","CONTEXT_MENU","ContextMenu","DBL_CLICK","DblClick","FOCUS","Focus","BLUR","Blur","TOUCH_START","TouchStart","TOUCH_END","TouchEnd","handler","getNodePrivacyLevel","NodePrivacyLevel","HIDDEN","type","interaction","record","assign","assembleIncrementalSnapshot","MouseInteraction","keys","_event","changedTouches","clientX","clientY","window","visualViewport","_convertMouseEventToLayoutCoordinates","convertMouseEventToLayoutCoordinates","visualViewportX","visualViewportY","isFinite","scrollPositions","scrollTop","getScrollY","scrollLeft","getScrollX","Math","round","addEventListener","SCROLL","initViewportObservable","subscribe","unsubscribe","lastInputStateMap","isShadowRoot","_addEventListeners","CHANGE","INPUT","HTMLInputElement","HTMLTextAreaElement","HTMLSelectElement","onElementChange","stopEventListeners","stopPropertySetterInstrumentation","instrumentationStoppers","instrumentSetter","forEach","stopper","noop","nodePrivacyLevel","inputState","shouldMaskNode","isChecked","checked","getElementInputValue","text","cbWithDedup","name","querySelectorAll","cssEscape","el","lastInputState","checkStyleSheetAndCallback","styleSheet","callback","ownerNode","instrumentMethodAndCallOriginal","CSSStyleSheet","before","rule","index","adds","removes","CSSGroupingRule","instrumentGroupingCSSRuleClass","CSSMediaRule","CSSSupportsRule","cls","push","_this","parentStyleSheet","path","getPathToNestedCSSRule","PLAY","MediaInteractionType","Play","Pause","PAUSE","has_focus","hasFocus","_updateDimension","getVisualViewport","RESIZE","LifeCycleEventType","RAW_RUM_EVENT_COLLECTED","data","rawRumEvent","RumEventType","ACTION","action","ActionType","frustration","length","domainContext","events","timestamp","date","RecordType","FrustrationRecord","frustrationTypes","map","e","composed","isNodeShadowHost","composedPath"],"sources":["../../../../src/domain/replay/record/observers.js"],"sourcesContent":["import {\n  instrumentSetter,\n  instrumentMethodAndCallOriginal,\n  assign,\n  throttle,\n  DOM_EVENT,\n  addEventListeners,\n  addEventListener,\n  noop,\n  LifeCycleEventType,\n  RumEventType,\n  ActionType,\n  isNodeShadowHost,\n  cssEscape,\n  getScrollX,\n  getScrollY\n} from '@cloudcare/browser-core'\nimport { initViewportObservable } from '../../initViewportObservable'\nimport { NodePrivacyLevel } from '../../../constants'\n\nimport {\n  RecordType,\n  IncrementalSource,\n  MediaInteractionType,\n  MouseInteractionType\n} from '../../../types'\nimport { getNodePrivacyLevel, shouldMaskNode } from './privacy'\nimport {\n  getElementInputValue,\n  getSerializedNodeId,\n  hasSerializedNode\n} from './serializationUtils'\nimport {\n  assembleIncrementalSnapshot,\n  forEach,\n  getPathToNestedCSSRule,\n  isTouchEvent\n} from './utils'\nimport { startMutationObserver } from './mutationObserver'\nimport {\n  getVisualViewport,\n  convertMouseEventToLayoutCoordinates\n} from './viewports'\n\nvar MOUSE_MOVE_OBSERVER_THRESHOLD = 50\nvar SCROLL_OBSERVER_THRESHOLD = 100\nvar VISUAL_VIEWPORT_OBSERVER_THRESHOLD = 200\n\nvar recordIds = new WeakMap()\nlet nextId = 1\n\nexport function getRecordIdForEvent(event) {\n  if (!recordIds.has(event)) {\n    recordIds.set(event, nextId++)\n  }\n  return recordIds.get(event)\n}\nexport function initObservers(o) {\n  var mutationHandler = initMutationObserver(\n    o.mutationCb,\n    o.configuration,\n    o.shadowRootsController\n  )\n  var mousemoveHandler = initMoveObserver(o.mousemoveCb)\n  var mouseInteractionHandler = initMouseInteractionObserver(\n    o.mouseInteractionCb,\n    o.configuration.defaultPrivacyLevel\n  )\n  var scrollHandler = initScrollObserver(\n    o.scrollCb,\n    o.configuration.defaultPrivacyLevel,\n    o.elementsScrollPositions\n  )\n  var viewportResizeHandler = initViewportResizeObserver(o.viewportResizeCb)\n  var inputHandler = initInputObserver(\n    o.inputCb,\n    o.configuration.defaultPrivacyLevel\n  )\n  var mediaInteractionHandler = initMediaInteractionObserver(\n    o.mediaInteractionCb,\n    o.configuration.defaultPrivacyLevel\n  )\n  var styleSheetObserver = initStyleSheetObserver(o.styleSheetCb)\n  var focusHandler = initFocusObserver(o.focusCb)\n  var visualViewportResizeHandler = initVisualViewportResizeObserver(\n    o.visualViewportResizeCb\n  )\n  var frustrationHandler = initFrustrationObserver(o.lifeCycle, o.frustrationCb)\n\n  return {\n    flush: function () {\n      mutationHandler.flush()\n    },\n    stop: function () {\n      mutationHandler.stop()\n      mousemoveHandler()\n      mouseInteractionHandler()\n      scrollHandler()\n      viewportResizeHandler()\n      inputHandler()\n      mediaInteractionHandler()\n      styleSheetObserver()\n      focusHandler()\n      visualViewportResizeHandler()\n      frustrationHandler()\n    }\n  }\n}\n\nexport function initMutationObserver(cb, configuration, shadowRootsController) {\n  return startMutationObserver(\n    cb,\n    configuration,\n    shadowRootsController,\n    document\n  )\n}\n\nexport function initMoveObserver(cb) {\n  var _updatePosition = throttle(\n    function (event) {\n      var target = getEventTarget(event)\n      if (hasSerializedNode(target)) {\n        var coordinates = tryToComputeCoordinates(event)\n        if (!coordinates) {\n          return\n        }\n        var position = {\n          id: getSerializedNodeId(target),\n          timeOffset: 0,\n          x: coordinates.x,\n          y: coordinates.y\n        }\n\n        cb(\n          [position],\n          isTouchEvent(event)\n            ? IncrementalSource.TouchMove\n            : IncrementalSource.MouseMove\n        )\n      }\n    },\n    MOUSE_MOVE_OBSERVER_THRESHOLD,\n    {\n      trailing: false\n    }\n  )\n  var cancelThrottle = _updatePosition.cancel\n  var updatePosition = _updatePosition.throttled\n\n  var _listener = addEventListeners(\n    document,\n    [DOM_EVENT.MOUSE_MOVE, DOM_EVENT.TOUCH_MOVE],\n    updatePosition,\n    {\n      capture: true,\n      passive: true\n    }\n  )\n  var removeListener = _listener.stop\n  return function () {\n    removeListener()\n    cancelThrottle()\n  }\n}\n\nvar eventTypeToMouseInteraction = {\n  // Listen for pointerup DOM events instead of mouseup for MouseInteraction/MouseUp records. This\n  // allows to reference such records from Frustration records.\n  //\n  // In the context of supporting Mobile Session Replay, we introduced `PointerInteraction` records\n  // used by the Mobile SDKs in place of `MouseInteraction`. In the future, we should replace\n  // `MouseInteraction` by `PointerInteraction` in the Browser SDK so we have an uniform way to\n  // convey such interaction. This would cleanly solve the issue since we would have\n  // `PointerInteraction/Up` records that we could reference from `Frustration` records.\n  [DOM_EVENT.POINTER_UP]: MouseInteractionType.MouseUp,\n\n  [DOM_EVENT.MOUSE_DOWN]: MouseInteractionType.MouseDown,\n  [DOM_EVENT.CLICK]: MouseInteractionType.Click,\n  [DOM_EVENT.CONTEXT_MENU]: MouseInteractionType.ContextMenu,\n  [DOM_EVENT.DBL_CLICK]: MouseInteractionType.DblClick,\n  [DOM_EVENT.FOCUS]: MouseInteractionType.Focus,\n  [DOM_EVENT.BLUR]: MouseInteractionType.Blur,\n  [DOM_EVENT.TOUCH_START]: MouseInteractionType.TouchStart,\n  [DOM_EVENT.TOUCH_END]: MouseInteractionType.TouchEnd\n}\nexport function initMouseInteractionObserver(cb, defaultPrivacyLevel) {\n  var handler = function (event) {\n    var target = getEventTarget(event)\n    if (\n      getNodePrivacyLevel(target, defaultPrivacyLevel) ===\n        NodePrivacyLevel.HIDDEN ||\n      !hasSerializedNode(target)\n    ) {\n      return\n    }\n    var id = getSerializedNodeId(target)\n    var type = eventTypeToMouseInteraction[event.type]\n\n    var interaction\n    if (\n      type !== MouseInteractionType.Blur &&\n      type !== MouseInteractionType.Focus\n    ) {\n      var coordinates = tryToComputeCoordinates(event)\n      if (!coordinates) {\n        return\n      }\n      interaction = { id: id, type: type, x: coordinates.x, y: coordinates.y }\n    } else {\n      interaction = { id: id, type: type }\n    }\n\n    var record = assign(\n      { id: getRecordIdForEvent(event) },\n      assembleIncrementalSnapshot(\n        IncrementalSource.MouseInteraction,\n        interaction\n      )\n    )\n    cb(record)\n  }\n  return addEventListeners(\n    document,\n    Object.keys(eventTypeToMouseInteraction),\n    handler,\n    {\n      capture: true,\n      passive: true\n    }\n  ).stop\n}\n\nfunction tryToComputeCoordinates(event) {\n  var _event = isTouchEvent(event) ? event.changedTouches[0] : event\n  var x = _event.clientX\n  var y = _event.clientY\n  if (window.visualViewport) {\n    var _convertMouseEventToLayoutCoordinates =\n      convertMouseEventToLayoutCoordinates(x, y)\n    x = _convertMouseEventToLayoutCoordinates.visualViewportX\n    y = _convertMouseEventToLayoutCoordinates.visualViewportY\n  }\n  if (!Number.isFinite(x) || !Number.isFinite(y)) {\n    return undefined\n  }\n  return { x: x, y: y }\n}\n\nfunction initScrollObserver(cb, defaultPrivacyLevel, elementsScrollPositions) {\n  var _updatePosition = throttle(function (event) {\n    var target = getEventTarget(event)\n    if (\n      !target ||\n      getNodePrivacyLevel(target, defaultPrivacyLevel) ===\n        NodePrivacyLevel.HIDDEN ||\n      !hasSerializedNode(target)\n    ) {\n      return\n    }\n    var id = getSerializedNodeId(target)\n    var scrollPositions =\n      target === document\n        ? {\n            scrollTop: getScrollY(),\n            scrollLeft: getScrollX()\n          }\n        : {\n            scrollTop: Math.round(target.scrollTop),\n            scrollLeft: Math.round(target.scrollLeft)\n          }\n    elementsScrollPositions.set(target, scrollPositions)\n    cb({\n      id: id,\n      x: scrollPositions.scrollLeft,\n      y: scrollPositions.scrollTop\n    })\n  }, SCROLL_OBSERVER_THRESHOLD)\n  var cancelThrottle = _updatePosition.cancel\n  var updatePosition = _updatePosition.throttled\n\n  var _listener = addEventListener(document, DOM_EVENT.SCROLL, updatePosition, {\n    capture: true,\n    passive: true\n  })\n  var removeListener = _listener.stop\n  return function () {\n    removeListener()\n    cancelThrottle()\n  }\n}\n\nfunction initViewportResizeObserver(cb) {\n  return initViewportObservable().subscribe(cb).unsubscribe\n}\n\nexport function initInputObserver(cb, defaultPrivacyLevel, target) {\n  if (target === undefined) {\n    target = document\n  }\n  var lastInputStateMap = new WeakMap()\n  var isShadowRoot = target !== document\n\n  var _addEventListeners = addEventListeners(\n    target,\n    // The 'input' event bubbles across shadow roots, so we don't have to listen for it on shadow\n    // roots since it will be handled by the event listener that we did add to the document. Only\n    // the 'change' event is blocked and needs to be handled on shadow roots.\n    isShadowRoot ? [DOM_EVENT.CHANGE] : [DOM_EVENT.INPUT, DOM_EVENT.CHANGE],\n    function (event) {\n      var target = getEventTarget(event)\n      if (\n        target instanceof HTMLInputElement ||\n        target instanceof HTMLTextAreaElement ||\n        target instanceof HTMLSelectElement\n      ) {\n        onElementChange(target)\n      }\n    },\n    {\n      capture: true,\n      passive: true\n    }\n  )\n  var stopEventListeners = _addEventListeners.stop\n  var stopPropertySetterInstrumentation\n  if (!isShadowRoot) {\n    const instrumentationStoppers = [\n      instrumentSetter(HTMLInputElement.prototype, 'value', onElementChange),\n      instrumentSetter(HTMLInputElement.prototype, 'checked', onElementChange),\n      instrumentSetter(HTMLSelectElement.prototype, 'value', onElementChange),\n      instrumentSetter(HTMLTextAreaElement.prototype, 'value', onElementChange),\n      instrumentSetter(\n        HTMLSelectElement.prototype,\n        'selectedIndex',\n        onElementChange\n      )\n    ]\n    stopPropertySetterInstrumentation = function () {\n      instrumentationStoppers.forEach(function (stopper) {\n        return stopper.stop()\n      })\n    }\n  } else {\n    stopPropertySetterInstrumentation = noop\n  }\n\n  return function () {\n    stopPropertySetterInstrumentation()\n    stopEventListeners()\n  }\n\n  function onElementChange(target) {\n    var nodePrivacyLevel = getNodePrivacyLevel(target, defaultPrivacyLevel)\n    if (nodePrivacyLevel === NodePrivacyLevel.HIDDEN) {\n      return\n    }\n\n    var type = target.type\n\n    let inputState\n    if (type === 'radio' || type === 'checkbox') {\n      if (shouldMaskNode(target, nodePrivacyLevel)) {\n        return\n      }\n      inputState = { isChecked: target.checked }\n    } else {\n      var value = getElementInputValue(target, nodePrivacyLevel)\n      if (value === undefined) {\n        return\n      }\n      inputState = { text: value }\n    }\n\n    // Can be multiple changes on the same node within the same batched mutation observation.\n    cbWithDedup(target, inputState)\n\n    // If a radio was checked, other radios with the same name attribute will be unchecked.\n    var name = target.name\n    if (type === 'radio' && name && target.checked) {\n      forEach(\n        document.querySelectorAll(\n          'input[type=\"radio\"][name=\"' + cssEscape(name) + '\"]'\n        ),\n        function (el) {\n          if (el !== target) {\n            cbWithDedup(el, { isChecked: false })\n          }\n        }\n      )\n    }\n  }\n\n  /**\n   * There can be multiple changes on the same node within the same batched mutation observation.\n   */\n  function cbWithDedup(target, inputState) {\n    if (!hasSerializedNode(target)) {\n      return\n    }\n    var lastInputState = lastInputStateMap.get(target)\n    if (\n      !lastInputState ||\n      lastInputState.text !== inputState.text ||\n      lastInputState.isChecked !== inputState.isChecked\n    ) {\n      lastInputStateMap.set(target, inputState)\n      cb(\n        assign(\n          {\n            id: getSerializedNodeId(target)\n          },\n          inputState\n        )\n      )\n    }\n  }\n}\n\nexport function initStyleSheetObserver(cb) {\n  function checkStyleSheetAndCallback(styleSheet, callback) {\n    if (styleSheet && hasSerializedNode(styleSheet.ownerNode)) {\n      callback(getSerializedNodeId(styleSheet.ownerNode))\n    }\n  }\n\n  var instrumentationStoppers = [\n    instrumentMethodAndCallOriginal(CSSStyleSheet.prototype, 'insertRule', {\n      before: function (rule, index) {\n        checkStyleSheetAndCallback(this, function (id) {\n          return cb({ id: id, adds: [{ rule: rule, index: index }] })\n        })\n      }\n    }),\n    instrumentMethodAndCallOriginal(CSSStyleSheet.prototype, 'deleteRule', {\n      before: function (index) {\n        checkStyleSheetAndCallback(this, function (id) {\n          return cb({ id: id, removes: [{ index: index }] })\n        })\n      }\n    })\n  ]\n\n  if (typeof CSSGroupingRule !== 'undefined') {\n    instrumentGroupingCSSRuleClass(CSSGroupingRule)\n  } else {\n    instrumentGroupingCSSRuleClass(CSSMediaRule)\n    instrumentGroupingCSSRuleClass(CSSSupportsRule)\n  }\n\n  function instrumentGroupingCSSRuleClass(cls) {\n    instrumentationStoppers.push(\n      instrumentMethodAndCallOriginal(cls.prototype, 'insertRule', {\n        before: function (rule, index) {\n          var _this = this\n          checkStyleSheetAndCallback(this.parentStyleSheet, function (id) {\n            var path = getPathToNestedCSSRule(_this)\n            if (path) {\n              path.push(index || 0)\n              cb({ id: id, adds: [{ rule: rule, index: path }] })\n            }\n          })\n        }\n      }),\n      instrumentMethodAndCallOriginal(cls.prototype, 'deleteRule', {\n        before: function (index) {\n          var _this = this\n          checkStyleSheetAndCallback(this.parentStyleSheet, function (id) {\n            var path = getPathToNestedCSSRule(_this)\n            if (path) {\n              path.push(index)\n              cb({ id: id, removes: [{ index: path }] })\n            }\n          })\n        }\n      })\n    )\n  }\n\n  return function () {\n    instrumentationStoppers.forEach(function (stopper) {\n      stopper.stop()\n    })\n  }\n}\n\nfunction initMediaInteractionObserver(mediaInteractionCb, defaultPrivacyLevel) {\n  var handler = function (event) {\n    var target = getEventTarget(event)\n    if (\n      !target ||\n      getNodePrivacyLevel(target, defaultPrivacyLevel) ===\n        NodePrivacyLevel.HIDDEN ||\n      !hasSerializedNode(target)\n    ) {\n      return\n    }\n    mediaInteractionCb({\n      id: getSerializedNodeId(target),\n      type:\n        event.type === DOM_EVENT.PLAY\n          ? MediaInteractionType.Play\n          : MediaInteractionType.Pause\n    })\n  }\n  return addEventListeners(\n    document,\n    [DOM_EVENT.PLAY, DOM_EVENT.PAUSE],\n    handler,\n    { capture: true, passive: true }\n  ).stop\n}\n\nfunction initFocusObserver(focusCb) {\n  return addEventListeners(\n    window,\n    [DOM_EVENT.FOCUS, DOM_EVENT.BLUR],\n    function () {\n      focusCb({ has_focus: document.hasFocus() })\n    }\n  ).stop\n}\n\nfunction initVisualViewportResizeObserver(cb) {\n  if (!window.visualViewport) {\n    return noop\n  }\n  var _updateDimension = throttle(\n    function () {\n      cb(getVisualViewport())\n    },\n    VISUAL_VIEWPORT_OBSERVER_THRESHOLD,\n    {\n      trailing: false\n    }\n  )\n  var removeListener = addEventListeners(\n    window.visualViewport,\n    [DOM_EVENT.RESIZE, DOM_EVENT.SCROLL],\n    _updateDimension.throttled,\n    {\n      capture: true,\n      passive: true\n    }\n  ).stop\n  var cancelThrottle = _updateDimension.cancel\n  return function stop() {\n    removeListener()\n    cancelThrottle()\n  }\n}\n\nexport function initFrustrationObserver(lifeCycle, frustrationCb) {\n  return lifeCycle.subscribe(\n    LifeCycleEventType.RAW_RUM_EVENT_COLLECTED,\n    function (data) {\n      if (\n        data.rawRumEvent.type === RumEventType.ACTION &&\n        data.rawRumEvent.action.type === ActionType.CLICK &&\n        data.rawRumEvent.action.frustration &&\n        data.rawRumEvent.action.frustration.type &&\n        data.rawRumEvent.action.frustration.type.length &&\n        'events' in data.domainContext &&\n        data.domainContext.events &&\n        data.domainContext.events.length\n      ) {\n        frustrationCb({\n          timestamp: data.rawRumEvent.date,\n          type: RecordType.FrustrationRecord,\n          data: {\n            frustrationTypes: data.rawRumEvent.action.frustration.type,\n            recordIds: data.domainContext.events.map(function (e) {\n              return getRecordIdForEvent(e)\n            })\n          }\n        })\n      }\n    }\n  ).unsubscribe\n}\n\nfunction getEventTarget(event) {\n  if (event.composed === true && isNodeShadowHost(event.target)) {\n    return event.composedPath()[0]\n  }\n  return event.target\n}\n"],"mappings":";;;;;;;;;;;;;AAAA,IAAAA,YAAA,GAAAC,OAAA;AAiBA,IAAAC,uBAAA,GAAAD,OAAA;AACA,IAAAE,UAAA,GAAAF,OAAA;AAEA,IAAAG,MAAA,GAAAH,OAAA;AAMA,IAAAI,QAAA,GAAAJ,OAAA;AACA,IAAAK,mBAAA,GAAAL,OAAA;AAKA,IAAAM,MAAA,GAAAN,OAAA;AAMA,IAAAO,iBAAA,GAAAP,OAAA;AACA,IAAAQ,UAAA,GAAAR,OAAA;AAGoB,IAAAS,qBAAA;AAAA,SAAAC,QAAAC,GAAA,sCAAAD,OAAA,wBAAAE,MAAA,uBAAAA,MAAA,CAAAC,QAAA,aAAAF,GAAA,kBAAAA,GAAA,gBAAAA,GAAA,WAAAA,GAAA,yBAAAC,MAAA,IAAAD,GAAA,CAAAG,WAAA,KAAAF,MAAA,IAAAD,GAAA,KAAAC,MAAA,CAAAG,SAAA,qBAAAJ,GAAA,KAAAD,OAAA,CAAAC,GAAA;AAAA,SAAAK,gBAAAL,GAAA,EAAAM,GAAA,EAAAC,KAAA,IAAAD,GAAA,GAAAE,cAAA,CAAAF,GAAA,OAAAA,GAAA,IAAAN,GAAA,IAAAS,MAAA,CAAAC,cAAA,CAAAV,GAAA,EAAAM,GAAA,IAAAC,KAAA,EAAAA,KAAA,EAAAI,UAAA,QAAAC,YAAA,QAAAC,QAAA,oBAAAb,GAAA,CAAAM,GAAA,IAAAC,KAAA,WAAAP,GAAA;AAAA,SAAAQ,eAAAM,GAAA,QAAAR,GAAA,GAAAS,YAAA,CAAAD,GAAA,oBAAAf,OAAA,CAAAO,GAAA,iBAAAA,GAAA,GAAAU,MAAA,CAAAV,GAAA;AAAA,SAAAS,aAAAE,KAAA,EAAAC,IAAA,QAAAnB,OAAA,CAAAkB,KAAA,kBAAAA,KAAA,kBAAAA,KAAA,MAAAE,IAAA,GAAAF,KAAA,CAAAhB,MAAA,CAAAmB,WAAA,OAAAD,IAAA,KAAAE,SAAA,QAAAC,GAAA,GAAAH,IAAA,CAAAI,IAAA,CAAAN,KAAA,EAAAC,IAAA,oBAAAnB,OAAA,CAAAuB,GAAA,uBAAAA,GAAA,YAAAE,SAAA,4DAAAN,IAAA,gBAAAF,MAAA,GAAAS,MAAA,EAAAR,KAAA;AAEpB,IAAIS,6BAA6B,GAAG,EAAE;AACtC,IAAIC,yBAAyB,GAAG,GAAG;AACnC,IAAIC,kCAAkC,GAAG,GAAG;AAE5C,IAAIC,SAAS,GAAG,IAAIC,OAAO,CAAC,CAAC;AAC7B,IAAIC,MAAM,GAAG,CAAC;AAEP,SAASC,mBAAmBA,CAACC,KAAK,EAAE;EACzC,IAAI,CAACJ,SAAS,CAACK,GAAG,CAACD,KAAK,CAAC,EAAE;IACzBJ,SAAS,CAACM,GAAG,CAACF,KAAK,EAAEF,MAAM,EAAE,CAAC;EAChC;EACA,OAAOF,SAAS,CAACO,GAAG,CAACH,KAAK,CAAC;AAC7B;AACO,SAASI,aAAaA,CAACC,CAAC,EAAE;EAC/B,IAAIC,eAAe,GAAGC,oBAAoB,CACxCF,CAAC,CAACG,UAAU,EACZH,CAAC,CAACI,aAAa,EACfJ,CAAC,CAACK,qBACJ,CAAC;EACD,IAAIC,gBAAgB,GAAGC,gBAAgB,CAACP,CAAC,CAACQ,WAAW,CAAC;EACtD,IAAIC,uBAAuB,GAAGC,4BAA4B,CACxDV,CAAC,CAACW,kBAAkB,EACpBX,CAAC,CAACI,aAAa,CAACQ,mBAClB,CAAC;EACD,IAAIC,aAAa,GAAGC,kBAAkB,CACpCd,CAAC,CAACe,QAAQ,EACVf,CAAC,CAACI,aAAa,CAACQ,mBAAmB,EACnCZ,CAAC,CAACgB,uBACJ,CAAC;EACD,IAAIC,qBAAqB,GAAGC,0BAA0B,CAAClB,CAAC,CAACmB,gBAAgB,CAAC;EAC1E,IAAIC,YAAY,GAAGC,iBAAiB,CAClCrB,CAAC,CAACsB,OAAO,EACTtB,CAAC,CAACI,aAAa,CAACQ,mBAClB,CAAC;EACD,IAAIW,uBAAuB,GAAGC,4BAA4B,CACxDxB,CAAC,CAACyB,kBAAkB,EACpBzB,CAAC,CAACI,aAAa,CAACQ,mBAClB,CAAC;EACD,IAAIc,kBAAkB,GAAGC,sBAAsB,CAAC3B,CAAC,CAAC4B,YAAY,CAAC;EAC/D,IAAIC,YAAY,GAAGC,iBAAiB,CAAC9B,CAAC,CAAC+B,OAAO,CAAC;EAC/C,IAAIC,2BAA2B,GAAGC,gCAAgC,CAChEjC,CAAC,CAACkC,sBACJ,CAAC;EACD,IAAIC,kBAAkB,GAAGC,uBAAuB,CAACpC,CAAC,CAACqC,SAAS,EAAErC,CAAC,CAACsC,aAAa,CAAC;EAE9E,OAAO;IACLC,KAAK,EAAE,SAAAA,MAAA,EAAY;MACjBtC,eAAe,CAACsC,KAAK,CAAC,CAAC;IACzB,CAAC;IACDC,IAAI,EAAE,SAAAA,KAAA,EAAY;MAChBvC,eAAe,CAACuC,IAAI,CAAC,CAAC;MACtBlC,gBAAgB,CAAC,CAAC;MAClBG,uBAAuB,CAAC,CAAC;MACzBI,aAAa,CAAC,CAAC;MACfI,qBAAqB,CAAC,CAAC;MACvBG,YAAY,CAAC,CAAC;MACdG,uBAAuB,CAAC,CAAC;MACzBG,kBAAkB,CAAC,CAAC;MACpBG,YAAY,CAAC,CAAC;MACdG,2BAA2B,CAAC,CAAC;MAC7BG,kBAAkB,CAAC,CAAC;IACtB;EACF,CAAC;AACH;AAEO,SAASjC,oBAAoBA,CAACuC,EAAE,EAAErC,aAAa,EAAEC,qBAAqB,EAAE;EAC7E,OAAO,IAAAqC,uCAAqB,EAC1BD,EAAE,EACFrC,aAAa,EACbC,qBAAqB,EACrBsC,QACF,CAAC;AACH;AAEO,SAASpC,gBAAgBA,CAACkC,EAAE,EAAE;EACnC,IAAIG,eAAe,GAAG,IAAAC,qBAAQ,EAC5B,UAAUlD,KAAK,EAAE;IACf,IAAImD,MAAM,GAAGC,cAAc,CAACpD,KAAK,CAAC;IAClC,IAAI,IAAAqD,qCAAiB,EAACF,MAAM,CAAC,EAAE;MAC7B,IAAIG,WAAW,GAAGC,uBAAuB,CAACvD,KAAK,CAAC;MAChD,IAAI,CAACsD,WAAW,EAAE;QAChB;MACF;MACA,IAAIE,QAAQ,GAAG;QACbC,EAAE,EAAE,IAAAC,uCAAmB,EAACP,MAAM,CAAC;QAC/BQ,UAAU,EAAE,CAAC;QACbC,CAAC,EAAEN,WAAW,CAACM,CAAC;QAChBC,CAAC,EAAEP,WAAW,CAACO;MACjB,CAAC;MAEDf,EAAE,CACA,CAACU,QAAQ,CAAC,EACV,IAAAM,mBAAY,EAAC9D,KAAK,CAAC,GACf+D,wBAAiB,CAACC,SAAS,GAC3BD,wBAAiB,CAACE,SACxB,CAAC;IACH;EACF,CAAC,EACDxE,6BAA6B,EAC7B;IACEyE,QAAQ,EAAE;EACZ,CACF,CAAC;EACD,IAAIC,cAAc,GAAGlB,eAAe,CAACmB,MAAM;EAC3C,IAAIC,cAAc,GAAGpB,eAAe,CAACqB,SAAS;EAE9C,IAAIC,SAAS,GAAG,IAAAC,8BAAiB,EAC/BxB,QAAQ,EACR,CAACyB,sBAAS,CAACC,UAAU,EAAED,sBAAS,CAACE,UAAU,CAAC,EAC5CN,cAAc,EACd;IACEO,OAAO,EAAE,IAAI;IACbC,OAAO,EAAE;EACX,CACF,CAAC;EACD,IAAIC,cAAc,GAAGP,SAAS,CAAC1B,IAAI;EACnC,OAAO,YAAY;IACjBiC,cAAc,CAAC,CAAC;IAChBX,cAAc,CAAC,CAAC;EAClB,CAAC;AACH;AAEA,IAAIY,2BAA2B,IAAAlH,qBAAA,OAAAO,eAAA,CAAAP,qBAAA,EAS5B4G,sBAAS,CAACO,UAAU,EAAGC,2BAAoB,CAACC,OAAO,GAAA9G,eAAA,CAAAP,qBAAA,EAEnD4G,sBAAS,CAACU,UAAU,EAAGF,2BAAoB,CAACG,SAAS,GAAAhH,eAAA,CAAAP,qBAAA,EACrD4G,sBAAS,CAACY,KAAK,EAAGJ,2BAAoB,CAACK,KAAK,GAAAlH,eAAA,CAAAP,qBAAA,EAC5C4G,sBAAS,CAACc,YAAY,EAAGN,2BAAoB,CAACO,WAAW,GAAApH,eAAA,CAAAP,qBAAA,EACzD4G,sBAAS,CAACgB,SAAS,EAAGR,2BAAoB,CAACS,QAAQ,GAAAtH,eAAA,CAAAP,qBAAA,EACnD4G,sBAAS,CAACkB,KAAK,EAAGV,2BAAoB,CAACW,KAAK,GAAAxH,eAAA,CAAAP,qBAAA,EAC5C4G,sBAAS,CAACoB,IAAI,EAAGZ,2BAAoB,CAACa,IAAI,GAAA1H,eAAA,CAAAP,qBAAA,EAC1C4G,sBAAS,CAACsB,WAAW,EAAGd,2BAAoB,CAACe,UAAU,GAAA5H,eAAA,CAAAP,qBAAA,EACvD4G,sBAAS,CAACwB,SAAS,EAAGhB,2BAAoB,CAACiB,QAAQ,GAAArI,qBAAA,CACrD;AACM,SAASkD,4BAA4BA,CAAC+B,EAAE,EAAE7B,mBAAmB,EAAE;EACpE,IAAIkF,OAAO,GAAG,SAAVA,OAAOA,CAAanG,KAAK,EAAE;IAC7B,IAAImD,MAAM,GAAGC,cAAc,CAACpD,KAAK,CAAC;IAClC,IACE,IAAAoG,4BAAmB,EAACjD,MAAM,EAAElC,mBAAmB,CAAC,KAC9CoF,2BAAgB,CAACC,MAAM,IACzB,CAAC,IAAAjD,qCAAiB,EAACF,MAAM,CAAC,EAC1B;MACA;IACF;IACA,IAAIM,EAAE,GAAG,IAAAC,uCAAmB,EAACP,MAAM,CAAC;IACpC,IAAIoD,IAAI,GAAGxB,2BAA2B,CAAC/E,KAAK,CAACuG,IAAI,CAAC;IAElD,IAAIC,WAAW;IACf,IACED,IAAI,KAAKtB,2BAAoB,CAACa,IAAI,IAClCS,IAAI,KAAKtB,2BAAoB,CAACW,KAAK,EACnC;MACA,IAAItC,WAAW,GAAGC,uBAAuB,CAACvD,KAAK,CAAC;MAChD,IAAI,CAACsD,WAAW,EAAE;QAChB;MACF;MACAkD,WAAW,GAAG;QAAE/C,EAAE,EAAEA,EAAE;QAAE8C,IAAI,EAAEA,IAAI;QAAE3C,CAAC,EAAEN,WAAW,CAACM,CAAC;QAAEC,CAAC,EAAEP,WAAW,CAACO;MAAE,CAAC;IAC1E,CAAC,MAAM;MACL2C,WAAW,GAAG;QAAE/C,EAAE,EAAEA,EAAE;QAAE8C,IAAI,EAAEA;MAAK,CAAC;IACtC;IAEA,IAAIE,MAAM,GAAG,IAAAC,mBAAM,EACjB;MAAEjD,EAAE,EAAE1D,mBAAmB,CAACC,KAAK;IAAE,CAAC,EAClC,IAAA2G,kCAA2B,EACzB5C,wBAAiB,CAAC6C,gBAAgB,EAClCJ,WACF,CACF,CAAC;IACD1D,EAAE,CAAC2D,MAAM,CAAC;EACZ,CAAC;EACD,OAAO,IAAAjC,8BAAiB,EACtBxB,QAAQ,EACRxE,MAAM,CAACqI,IAAI,CAAC9B,2BAA2B,CAAC,EACxCoB,OAAO,EACP;IACEvB,OAAO,EAAE,IAAI;IACbC,OAAO,EAAE;EACX,CACF,CAAC,CAAChC,IAAI;AACR;AAEA,SAASU,uBAAuBA,CAACvD,KAAK,EAAE;EACtC,IAAI8G,MAAM,GAAG,IAAAhD,mBAAY,EAAC9D,KAAK,CAAC,GAAGA,KAAK,CAAC+G,cAAc,CAAC,CAAC,CAAC,GAAG/G,KAAK;EAClE,IAAI4D,CAAC,GAAGkD,MAAM,CAACE,OAAO;EACtB,IAAInD,CAAC,GAAGiD,MAAM,CAACG,OAAO;EACtB,IAAIC,MAAM,CAACC,cAAc,EAAE;IACzB,IAAIC,qCAAqC,GACvC,IAAAC,+CAAoC,EAACzD,CAAC,EAAEC,CAAC,CAAC;IAC5CD,CAAC,GAAGwD,qCAAqC,CAACE,eAAe;IACzDzD,CAAC,GAAGuD,qCAAqC,CAACG,eAAe;EAC3D;EACA,IAAI,CAAC/H,MAAM,CAACgI,QAAQ,CAAC5D,CAAC,CAAC,IAAI,CAACpE,MAAM,CAACgI,QAAQ,CAAC3D,CAAC,CAAC,EAAE;IAC9C,OAAOzE,SAAS;EAClB;EACA,OAAO;IAAEwE,CAAC,EAAEA,CAAC;IAAEC,CAAC,EAAEA;EAAE,CAAC;AACvB;AAEA,SAAS1C,kBAAkBA,CAAC2B,EAAE,EAAE7B,mBAAmB,EAAEI,uBAAuB,EAAE;EAC5E,IAAI4B,eAAe,GAAG,IAAAC,qBAAQ,EAAC,UAAUlD,KAAK,EAAE;IAC9C,IAAImD,MAAM,GAAGC,cAAc,CAACpD,KAAK,CAAC;IAClC,IACE,CAACmD,MAAM,IACP,IAAAiD,4BAAmB,EAACjD,MAAM,EAAElC,mBAAmB,CAAC,KAC9CoF,2BAAgB,CAACC,MAAM,IACzB,CAAC,IAAAjD,qCAAiB,EAACF,MAAM,CAAC,EAC1B;MACA;IACF;IACA,IAAIM,EAAE,GAAG,IAAAC,uCAAmB,EAACP,MAAM,CAAC;IACpC,IAAIsE,eAAe,GACjBtE,MAAM,KAAKH,QAAQ,GACf;MACE0E,SAAS,EAAE,IAAAC,uBAAU,EAAC,CAAC;MACvBC,UAAU,EAAE,IAAAC,uBAAU,EAAC;IACzB,CAAC,GACD;MACEH,SAAS,EAAEI,IAAI,CAACC,KAAK,CAAC5E,MAAM,CAACuE,SAAS,CAAC;MACvCE,UAAU,EAAEE,IAAI,CAACC,KAAK,CAAC5E,MAAM,CAACyE,UAAU;IAC1C,CAAC;IACPvG,uBAAuB,CAACnB,GAAG,CAACiD,MAAM,EAAEsE,eAAe,CAAC;IACpD3E,EAAE,CAAC;MACDW,EAAE,EAAEA,EAAE;MACNG,CAAC,EAAE6D,eAAe,CAACG,UAAU;MAC7B/D,CAAC,EAAE4D,eAAe,CAACC;IACrB,CAAC,CAAC;EACJ,CAAC,EAAEhI,yBAAyB,CAAC;EAC7B,IAAIyE,cAAc,GAAGlB,eAAe,CAACmB,MAAM;EAC3C,IAAIC,cAAc,GAAGpB,eAAe,CAACqB,SAAS;EAE9C,IAAIC,SAAS,GAAG,IAAAyD,6BAAgB,EAAChF,QAAQ,EAAEyB,sBAAS,CAACwD,MAAM,EAAE5D,cAAc,EAAE;IAC3EO,OAAO,EAAE,IAAI;IACbC,OAAO,EAAE;EACX,CAAC,CAAC;EACF,IAAIC,cAAc,GAAGP,SAAS,CAAC1B,IAAI;EACnC,OAAO,YAAY;IACjBiC,cAAc,CAAC,CAAC;IAChBX,cAAc,CAAC,CAAC;EAClB,CAAC;AACH;AAEA,SAAS5C,0BAA0BA,CAACuB,EAAE,EAAE;EACtC,OAAO,IAAAoF,8CAAsB,EAAC,CAAC,CAACC,SAAS,CAACrF,EAAE,CAAC,CAACsF,WAAW;AAC3D;AAEO,SAAS1G,iBAAiBA,CAACoB,EAAE,EAAE7B,mBAAmB,EAAEkC,MAAM,EAAE;EACjE,IAAIA,MAAM,KAAK/D,SAAS,EAAE;IACxB+D,MAAM,GAAGH,QAAQ;EACnB;EACA,IAAIqF,iBAAiB,GAAG,IAAIxI,OAAO,CAAC,CAAC;EACrC,IAAIyI,YAAY,GAAGnF,MAAM,KAAKH,QAAQ;EAEtC,IAAIuF,kBAAkB,GAAG,IAAA/D,8BAAiB,EACxCrB,MAAM;EACN;EACA;EACA;EACAmF,YAAY,GAAG,CAAC7D,sBAAS,CAAC+D,MAAM,CAAC,GAAG,CAAC/D,sBAAS,CAACgE,KAAK,EAAEhE,sBAAS,CAAC+D,MAAM,CAAC,EACvE,UAAUxI,KAAK,EAAE;IACf,IAAImD,MAAM,GAAGC,cAAc,CAACpD,KAAK,CAAC;IAClC,IACEmD,MAAM,YAAYuF,gBAAgB,IAClCvF,MAAM,YAAYwF,mBAAmB,IACrCxF,MAAM,YAAYyF,iBAAiB,EACnC;MACAC,eAAe,CAAC1F,MAAM,CAAC;IACzB;EACF,CAAC,EACD;IACEyB,OAAO,EAAE,IAAI;IACbC,OAAO,EAAE;EACX,CACF,CAAC;EACD,IAAIiE,kBAAkB,GAAGP,kBAAkB,CAAC1F,IAAI;EAChD,IAAIkG,iCAAiC;EACrC,IAAI,CAACT,YAAY,EAAE;IACjB,IAAMU,uBAAuB,GAAG,CAC9B,IAAAC,6BAAgB,EAACP,gBAAgB,CAACvK,SAAS,EAAE,OAAO,EAAE0K,eAAe,CAAC,EACtE,IAAAI,6BAAgB,EAACP,gBAAgB,CAACvK,SAAS,EAAE,SAAS,EAAE0K,eAAe,CAAC,EACxE,IAAAI,6BAAgB,EAACL,iBAAiB,CAACzK,SAAS,EAAE,OAAO,EAAE0K,eAAe,CAAC,EACvE,IAAAI,6BAAgB,EAACN,mBAAmB,CAACxK,SAAS,EAAE,OAAO,EAAE0K,eAAe,CAAC,EACzE,IAAAI,6BAAgB,EACdL,iBAAiB,CAACzK,SAAS,EAC3B,eAAe,EACf0K,eACF,CAAC,CACF;IACDE,iCAAiC,GAAG,SAAAA,kCAAA,EAAY;MAC9CC,uBAAuB,CAACE,OAAO,CAAC,UAAUC,OAAO,EAAE;QACjD,OAAOA,OAAO,CAACtG,IAAI,CAAC,CAAC;MACvB,CAAC,CAAC;IACJ,CAAC;EACH,CAAC,MAAM;IACLkG,iCAAiC,GAAGK,iBAAI;EAC1C;EAEA,OAAO,YAAY;IACjBL,iCAAiC,CAAC,CAAC;IACnCD,kBAAkB,CAAC,CAAC;EACtB,CAAC;EAED,SAASD,eAAeA,CAAC1F,MAAM,EAAE;IAC/B,IAAIkG,gBAAgB,GAAG,IAAAjD,4BAAmB,EAACjD,MAAM,EAAElC,mBAAmB,CAAC;IACvE,IAAIoI,gBAAgB,KAAKhD,2BAAgB,CAACC,MAAM,EAAE;MAChD;IACF;IAEA,IAAIC,IAAI,GAAGpD,MAAM,CAACoD,IAAI;IAEtB,IAAI+C,UAAU;IACd,IAAI/C,IAAI,KAAK,OAAO,IAAIA,IAAI,KAAK,UAAU,EAAE;MAC3C,IAAI,IAAAgD,uBAAc,EAACpG,MAAM,EAAEkG,gBAAgB,CAAC,EAAE;QAC5C;MACF;MACAC,UAAU,GAAG;QAAEE,SAAS,EAAErG,MAAM,CAACsG;MAAQ,CAAC;IAC5C,CAAC,MAAM;MACL,IAAInL,KAAK,GAAG,IAAAoL,wCAAoB,EAACvG,MAAM,EAAEkG,gBAAgB,CAAC;MAC1D,IAAI/K,KAAK,KAAKc,SAAS,EAAE;QACvB;MACF;MACAkK,UAAU,GAAG;QAAEK,IAAI,EAAErL;MAAM,CAAC;IAC9B;;IAEA;IACAsL,WAAW,CAACzG,MAAM,EAAEmG,UAAU,CAAC;;IAE/B;IACA,IAAIO,IAAI,GAAG1G,MAAM,CAAC0G,IAAI;IACtB,IAAItD,IAAI,KAAK,OAAO,IAAIsD,IAAI,IAAI1G,MAAM,CAACsG,OAAO,EAAE;MAC9C,IAAAP,cAAO,EACLlG,QAAQ,CAAC8G,gBAAgB,CACvB,4BAA4B,GAAG,IAAAC,sBAAS,EAACF,IAAI,CAAC,GAAG,IACnD,CAAC,EACD,UAAUG,EAAE,EAAE;QACZ,IAAIA,EAAE,KAAK7G,MAAM,EAAE;UACjByG,WAAW,CAACI,EAAE,EAAE;YAAER,SAAS,EAAE;UAAM,CAAC,CAAC;QACvC;MACF,CACF,CAAC;IACH;EACF;;EAEA;AACF;AACA;EACE,SAASI,WAAWA,CAACzG,MAAM,EAAEmG,UAAU,EAAE;IACvC,IAAI,CAAC,IAAAjG,qCAAiB,EAACF,MAAM,CAAC,EAAE;MAC9B;IACF;IACA,IAAI8G,cAAc,GAAG5B,iBAAiB,CAAClI,GAAG,CAACgD,MAAM,CAAC;IAClD,IACE,CAAC8G,cAAc,IACfA,cAAc,CAACN,IAAI,KAAKL,UAAU,CAACK,IAAI,IACvCM,cAAc,CAACT,SAAS,KAAKF,UAAU,CAACE,SAAS,EACjD;MACAnB,iBAAiB,CAACnI,GAAG,CAACiD,MAAM,EAAEmG,UAAU,CAAC;MACzCxG,EAAE,CACA,IAAA4D,mBAAM,EACJ;QACEjD,EAAE,EAAE,IAAAC,uCAAmB,EAACP,MAAM;MAChC,CAAC,EACDmG,UACF,CACF,CAAC;IACH;EACF;AACF;AAEO,SAAStH,sBAAsBA,CAACc,EAAE,EAAE;EACzC,SAASoH,0BAA0BA,CAACC,UAAU,EAAEC,QAAQ,EAAE;IACxD,IAAID,UAAU,IAAI,IAAA9G,qCAAiB,EAAC8G,UAAU,CAACE,SAAS,CAAC,EAAE;MACzDD,QAAQ,CAAC,IAAA1G,uCAAmB,EAACyG,UAAU,CAACE,SAAS,CAAC,CAAC;IACrD;EACF;EAEA,IAAIrB,uBAAuB,GAAG,CAC5B,IAAAsB,4CAA+B,EAACC,aAAa,CAACpM,SAAS,EAAE,YAAY,EAAE;IACrEqM,MAAM,EAAE,SAAAA,OAAUC,IAAI,EAAEC,KAAK,EAAE;MAC7BR,0BAA0B,CAAC,IAAI,EAAE,UAAUzG,EAAE,EAAE;QAC7C,OAAOX,EAAE,CAAC;UAAEW,EAAE,EAAEA,EAAE;UAAEkH,IAAI,EAAE,CAAC;YAAEF,IAAI,EAAEA,IAAI;YAAEC,KAAK,EAAEA;UAAM,CAAC;QAAE,CAAC,CAAC;MAC7D,CAAC,CAAC;IACJ;EACF,CAAC,CAAC,EACF,IAAAJ,4CAA+B,EAACC,aAAa,CAACpM,SAAS,EAAE,YAAY,EAAE;IACrEqM,MAAM,EAAE,SAAAA,OAAUE,KAAK,EAAE;MACvBR,0BAA0B,CAAC,IAAI,EAAE,UAAUzG,EAAE,EAAE;QAC7C,OAAOX,EAAE,CAAC;UAAEW,EAAE,EAAEA,EAAE;UAAEmH,OAAO,EAAE,CAAC;YAAEF,KAAK,EAAEA;UAAM,CAAC;QAAE,CAAC,CAAC;MACpD,CAAC,CAAC;IACJ;EACF,CAAC,CAAC,CACH;EAED,IAAI,OAAOG,eAAe,KAAK,WAAW,EAAE;IAC1CC,8BAA8B,CAACD,eAAe,CAAC;EACjD,CAAC,MAAM;IACLC,8BAA8B,CAACC,YAAY,CAAC;IAC5CD,8BAA8B,CAACE,eAAe,CAAC;EACjD;EAEA,SAASF,8BAA8BA,CAACG,GAAG,EAAE;IAC3CjC,uBAAuB,CAACkC,IAAI,CAC1B,IAAAZ,4CAA+B,EAACW,GAAG,CAAC9M,SAAS,EAAE,YAAY,EAAE;MAC3DqM,MAAM,EAAE,SAAAA,OAAUC,IAAI,EAAEC,KAAK,EAAE;QAC7B,IAAIS,KAAK,GAAG,IAAI;QAChBjB,0BAA0B,CAAC,IAAI,CAACkB,gBAAgB,EAAE,UAAU3H,EAAE,EAAE;UAC9D,IAAI4H,IAAI,GAAG,IAAAC,6BAAsB,EAACH,KAAK,CAAC;UACxC,IAAIE,IAAI,EAAE;YACRA,IAAI,CAACH,IAAI,CAACR,KAAK,IAAI,CAAC,CAAC;YACrB5H,EAAE,CAAC;cAAEW,EAAE,EAAEA,EAAE;cAAEkH,IAAI,EAAE,CAAC;gBAAEF,IAAI,EAAEA,IAAI;gBAAEC,KAAK,EAAEW;cAAK,CAAC;YAAE,CAAC,CAAC;UACrD;QACF,CAAC,CAAC;MACJ;IACF,CAAC,CAAC,EACF,IAAAf,4CAA+B,EAACW,GAAG,CAAC9M,SAAS,EAAE,YAAY,EAAE;MAC3DqM,MAAM,EAAE,SAAAA,OAAUE,KAAK,EAAE;QACvB,IAAIS,KAAK,GAAG,IAAI;QAChBjB,0BAA0B,CAAC,IAAI,CAACkB,gBAAgB,EAAE,UAAU3H,EAAE,EAAE;UAC9D,IAAI4H,IAAI,GAAG,IAAAC,6BAAsB,EAACH,KAAK,CAAC;UACxC,IAAIE,IAAI,EAAE;YACRA,IAAI,CAACH,IAAI,CAACR,KAAK,CAAC;YAChB5H,EAAE,CAAC;cAAEW,EAAE,EAAEA,EAAE;cAAEmH,OAAO,EAAE,CAAC;gBAAEF,KAAK,EAAEW;cAAK,CAAC;YAAE,CAAC,CAAC;UAC5C;QACF,CAAC,CAAC;MACJ;IACF,CAAC,CACH,CAAC;EACH;EAEA,OAAO,YAAY;IACjBrC,uBAAuB,CAACE,OAAO,CAAC,UAAUC,OAAO,EAAE;MACjDA,OAAO,CAACtG,IAAI,CAAC,CAAC;IAChB,CAAC,CAAC;EACJ,CAAC;AACH;AAEA,SAAShB,4BAA4BA,CAACC,kBAAkB,EAAEb,mBAAmB,EAAE;EAC7E,IAAIkF,OAAO,GAAG,SAAVA,OAAOA,CAAanG,KAAK,EAAE;IAC7B,IAAImD,MAAM,GAAGC,cAAc,CAACpD,KAAK,CAAC;IAClC,IACE,CAACmD,MAAM,IACP,IAAAiD,4BAAmB,EAACjD,MAAM,EAAElC,mBAAmB,CAAC,KAC9CoF,2BAAgB,CAACC,MAAM,IACzB,CAAC,IAAAjD,qCAAiB,EAACF,MAAM,CAAC,EAC1B;MACA;IACF;IACArB,kBAAkB,CAAC;MACjB2B,EAAE,EAAE,IAAAC,uCAAmB,EAACP,MAAM,CAAC;MAC/BoD,IAAI,EACFvG,KAAK,CAACuG,IAAI,KAAK9B,sBAAS,CAAC8G,IAAI,GACzBC,2BAAoB,CAACC,IAAI,GACzBD,2BAAoB,CAACE;IAC7B,CAAC,CAAC;EACJ,CAAC;EACD,OAAO,IAAAlH,8BAAiB,EACtBxB,QAAQ,EACR,CAACyB,sBAAS,CAAC8G,IAAI,EAAE9G,sBAAS,CAACkH,KAAK,CAAC,EACjCxF,OAAO,EACP;IAAEvB,OAAO,EAAE,IAAI;IAAEC,OAAO,EAAE;EAAK,CACjC,CAAC,CAAChC,IAAI;AACR;AAEA,SAASV,iBAAiBA,CAACC,OAAO,EAAE;EAClC,OAAO,IAAAoC,8BAAiB,EACtB0C,MAAM,EACN,CAACzC,sBAAS,CAACkB,KAAK,EAAElB,sBAAS,CAACoB,IAAI,CAAC,EACjC,YAAY;IACVzD,OAAO,CAAC;MAAEwJ,SAAS,EAAE5I,QAAQ,CAAC6I,QAAQ,CAAC;IAAE,CAAC,CAAC;EAC7C,CACF,CAAC,CAAChJ,IAAI;AACR;AAEA,SAASP,gCAAgCA,CAACQ,EAAE,EAAE;EAC5C,IAAI,CAACoE,MAAM,CAACC,cAAc,EAAE;IAC1B,OAAOiC,iBAAI;EACb;EACA,IAAI0C,gBAAgB,GAAG,IAAA5I,qBAAQ,EAC7B,YAAY;IACVJ,EAAE,CAAC,IAAAiJ,4BAAiB,EAAC,CAAC,CAAC;EACzB,CAAC,EACDpM,kCAAkC,EAClC;IACEuE,QAAQ,EAAE;EACZ,CACF,CAAC;EACD,IAAIY,cAAc,GAAG,IAAAN,8BAAiB,EACpC0C,MAAM,CAACC,cAAc,EACrB,CAAC1C,sBAAS,CAACuH,MAAM,EAAEvH,sBAAS,CAACwD,MAAM,CAAC,EACpC6D,gBAAgB,CAACxH,SAAS,EAC1B;IACEM,OAAO,EAAE,IAAI;IACbC,OAAO,EAAE;EACX,CACF,CAAC,CAAChC,IAAI;EACN,IAAIsB,cAAc,GAAG2H,gBAAgB,CAAC1H,MAAM;EAC5C,OAAO,SAASvB,IAAIA,CAAA,EAAG;IACrBiC,cAAc,CAAC,CAAC;IAChBX,cAAc,CAAC,CAAC;EAClB,CAAC;AACH;AAEO,SAAS1B,uBAAuBA,CAACC,SAAS,EAAEC,aAAa,EAAE;EAChE,OAAOD,SAAS,CAACyF,SAAS,CACxB8D,+BAAkB,CAACC,uBAAuB,EAC1C,UAAUC,IAAI,EAAE;IACd,IACEA,IAAI,CAACC,WAAW,CAAC7F,IAAI,KAAK8F,yBAAY,CAACC,MAAM,IAC7CH,IAAI,CAACC,WAAW,CAACG,MAAM,CAAChG,IAAI,KAAKiG,uBAAU,CAACnH,KAAK,IACjD8G,IAAI,CAACC,WAAW,CAACG,MAAM,CAACE,WAAW,IACnCN,IAAI,CAACC,WAAW,CAACG,MAAM,CAACE,WAAW,CAAClG,IAAI,IACxC4F,IAAI,CAACC,WAAW,CAACG,MAAM,CAACE,WAAW,CAAClG,IAAI,CAACmG,MAAM,IAC/C,QAAQ,IAAIP,IAAI,CAACQ,aAAa,IAC9BR,IAAI,CAACQ,aAAa,CAACC,MAAM,IACzBT,IAAI,CAACQ,aAAa,CAACC,MAAM,CAACF,MAAM,EAChC;MACA/J,aAAa,CAAC;QACZkK,SAAS,EAAEV,IAAI,CAACC,WAAW,CAACU,IAAI;QAChCvG,IAAI,EAAEwG,iBAAU,CAACC,iBAAiB;QAClCb,IAAI,EAAE;UACJc,gBAAgB,EAAEd,IAAI,CAACC,WAAW,CAACG,MAAM,CAACE,WAAW,CAAClG,IAAI;UAC1D3G,SAAS,EAAEuM,IAAI,CAACQ,aAAa,CAACC,MAAM,CAACM,GAAG,CAAC,UAAUC,CAAC,EAAE;YACpD,OAAOpN,mBAAmB,CAACoN,CAAC,CAAC;UAC/B,CAAC;QACH;MACF,CAAC,CAAC;IACJ;EACF,CACF,CAAC,CAAC/E,WAAW;AACf;AAEA,SAAShF,cAAcA,CAACpD,KAAK,EAAE;EAC7B,IAAIA,KAAK,CAACoN,QAAQ,KAAK,IAAI,IAAI,IAAAC,6BAAgB,EAACrN,KAAK,CAACmD,MAAM,CAAC,EAAE;IAC7D,OAAOnD,KAAK,CAACsN,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;EAChC;EACA,OAAOtN,KAAK,CAACmD,MAAM;AACrB","ignoreList":[]}