{"version":3,"file":"traceIdentifier.js","names":["TraceIdentifier","buffer","Uint8Array","getCrypto","getRandomValues","prototype","toString","radix","high","readInt32","low","str","mod","Math","floor","toDecimalString","toPaddedHexadecimalString","traceId","Array","length","join","offset","window","crypto","msCrypto"],"sources":["../../../src/domain/tracing/traceIdentifier.js"],"sourcesContent":["export function TraceIdentifier() {\n  this.buffer = new Uint8Array(8)\n  getCrypto().getRandomValues(this.buffer)\n  this.buffer[0] = this.buffer[0] & 0x7f\n}\n\nTraceIdentifier.prototype = {\n  // buffer: new Uint8Array(8),\n  toString: function (radix) {\n    var high = this.readInt32(0)\n    var low = this.readInt32(4)\n    var str = ''\n\n    do {\n      var mod = (high % radix) * 4294967296 + low\n      high = Math.floor(high / radix)\n      low = Math.floor(mod / radix)\n      str = (mod % radix).toString(radix) + str\n    } while (high || low)\n    return str\n  },\n  toDecimalString: function () {\n    return this.toString(10)\n  },\n  /**\n   * Format used by OTel headers\n   */\n  toPaddedHexadecimalString() {\n    var traceId = this.toString(16)\n    return Array(17 - traceId.length).join('0') + traceId\n  },\n  readInt32: function (offset) {\n    return (\n      this.buffer[offset] * 16777216 +\n      (this.buffer[offset + 1] << 16) +\n      (this.buffer[offset + 2] << 8) +\n      this.buffer[offset + 3]\n    )\n  }\n}\nexport function getCrypto() {\n  return window.crypto || window.msCrypto\n}\n"],"mappings":";;;;;;;AAAO,SAASA,eAAeA,CAAA,EAAG;EAChC,IAAI,CAACC,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC,CAAC;EAC/BC,SAAS,CAAC,CAAC,CAACC,eAAe,CAAC,IAAI,CAACH,MAAM,CAAC;EACxC,IAAI,CAACA,MAAM,CAAC,CAAC,CAAC,GAAG,IAAI,CAACA,MAAM,CAAC,CAAC,CAAC,GAAG,IAAI;AACxC;AAEAD,eAAe,CAACK,SAAS,GAAG;EAC1B;EACAC,QAAQ,EAAE,SAAAA,SAAUC,KAAK,EAAE;IACzB,IAAIC,IAAI,GAAG,IAAI,CAACC,SAAS,CAAC,CAAC,CAAC;IAC5B,IAAIC,GAAG,GAAG,IAAI,CAACD,SAAS,CAAC,CAAC,CAAC;IAC3B,IAAIE,GAAG,GAAG,EAAE;IAEZ,GAAG;MACD,IAAIC,GAAG,GAAIJ,IAAI,GAAGD,KAAK,GAAI,UAAU,GAAGG,GAAG;MAC3CF,IAAI,GAAGK,IAAI,CAACC,KAAK,CAACN,IAAI,GAAGD,KAAK,CAAC;MAC/BG,GAAG,GAAGG,IAAI,CAACC,KAAK,CAACF,GAAG,GAAGL,KAAK,CAAC;MAC7BI,GAAG,GAAG,CAACC,GAAG,GAAGL,KAAK,EAAED,QAAQ,CAACC,KAAK,CAAC,GAAGI,GAAG;IAC3C,CAAC,QAAQH,IAAI,IAAIE,GAAG;IACpB,OAAOC,GAAG;EACZ,CAAC;EACDI,eAAe,EAAE,SAAAA,gBAAA,EAAY;IAC3B,OAAO,IAAI,CAACT,QAAQ,CAAC,EAAE,CAAC;EAC1B,CAAC;EACD;AACF;AACA;EACEU,yBAAyB,WAAAA,0BAAA,EAAG;IAC1B,IAAIC,OAAO,GAAG,IAAI,CAACX,QAAQ,CAAC,EAAE,CAAC;IAC/B,OAAOY,KAAK,CAAC,EAAE,GAAGD,OAAO,CAACE,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC,GAAGH,OAAO;EACvD,CAAC;EACDR,SAAS,EAAE,SAAAA,UAAUY,MAAM,EAAE;IAC3B,OACE,IAAI,CAACpB,MAAM,CAACoB,MAAM,CAAC,GAAG,QAAQ,IAC7B,IAAI,CAACpB,MAAM,CAACoB,MAAM,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC,IAC9B,IAAI,CAACpB,MAAM,CAACoB,MAAM,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,GAC9B,IAAI,CAACpB,MAAM,CAACoB,MAAM,GAAG,CAAC,CAAC;EAE3B;AACF,CAAC;AACM,SAASlB,SAASA,CAAA,EAAG;EAC1B,OAAOmB,MAAM,CAACC,MAAM,IAAID,MAAM,CAACE,QAAQ;AACzC","ignoreList":[]}