{"version":3,"file":"internalContext.js","names":["startInternalContext","applicationId","sessionManager","viewContexts","actionContexts","urlContexts","get","startTime","viewContext","findView","urlContext","findUrl","session","findTrackedSession","actionId","findActionId","actionIds","findAllActionId","application","id","userAction","ids","undefined","view","name","url","referrer","host","path","pathGroup","urlQuery"],"sources":["../../../src/domain/contexts/internalContext.js"],"sourcesContent":["/**\n * Internal context keep returning v1 format\n * to not break compatibility with logs data format\n */\nexport function startInternalContext(\n  applicationId,\n  sessionManager,\n  viewContexts,\n  actionContexts,\n  urlContexts\n) {\n  return {\n    get: function (startTime) {\n      var viewContext = viewContexts.findView(startTime)\n      var urlContext = urlContexts.findUrl(startTime)\n      var session = sessionManager.findTrackedSession(startTime)\n      if (session && viewContext && urlContext) {\n        var actionId = actionContexts.findActionId(startTime)\n        var actionIds = actionContexts.findAllActionId(startTime)\n        return {\n          application: {\n            id: applicationId\n          },\n          session: {\n            id: session.id\n          },\n          userAction: actionId\n            ? {\n                id: actionId,\n                ids: actionIds\n              }\n            : undefined,\n          view: {\n            id: viewContext.id,\n            name: viewContext.name,\n            url: urlContext.url,\n            referrer: urlContext.referrer,\n            host: urlContext.host,\n            path: urlContext.path,\n            pathGroup: urlContext.pathGroup,\n            urlQuery: urlContext.urlQuery\n          }\n        }\n      }\n    }\n  }\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAO,SAASA,oBAAoBA,CAClCC,aAAa,EACbC,cAAc,EACdC,YAAY,EACZC,cAAc,EACdC,WAAW,EACX;EACA,OAAO;IACLC,GAAG,EAAE,SAAAA,IAAUC,SAAS,EAAE;MACxB,IAAIC,WAAW,GAAGL,YAAY,CAACM,QAAQ,CAACF,SAAS,CAAC;MAClD,IAAIG,UAAU,GAAGL,WAAW,CAACM,OAAO,CAACJ,SAAS,CAAC;MAC/C,IAAIK,OAAO,GAAGV,cAAc,CAACW,kBAAkB,CAACN,SAAS,CAAC;MAC1D,IAAIK,OAAO,IAAIJ,WAAW,IAAIE,UAAU,EAAE;QACxC,IAAII,QAAQ,GAAGV,cAAc,CAACW,YAAY,CAACR,SAAS,CAAC;QACrD,IAAIS,SAAS,GAAGZ,cAAc,CAACa,eAAe,CAACV,SAAS,CAAC;QACzD,OAAO;UACLW,WAAW,EAAE;YACXC,EAAE,EAAElB;UACN,CAAC;UACDW,OAAO,EAAE;YACPO,EAAE,EAAEP,OAAO,CAACO;UACd,CAAC;UACDC,UAAU,EAAEN,QAAQ,GAChB;YACEK,EAAE,EAAEL,QAAQ;YACZO,GAAG,EAAEL;UACP,CAAC,GACDM,SAAS;UACbC,IAAI,EAAE;YACJJ,EAAE,EAAEX,WAAW,CAACW,EAAE;YAClBK,IAAI,EAAEhB,WAAW,CAACgB,IAAI;YACtBC,GAAG,EAAEf,UAAU,CAACe,GAAG;YACnBC,QAAQ,EAAEhB,UAAU,CAACgB,QAAQ;YAC7BC,IAAI,EAAEjB,UAAU,CAACiB,IAAI;YACrBC,IAAI,EAAElB,UAAU,CAACkB,IAAI;YACrBC,SAAS,EAAEnB,UAAU,CAACmB,SAAS;YAC/BC,QAAQ,EAAEpB,UAAU,CAACoB;UACvB;QACF,CAAC;MACH;IACF;EACF,CAAC;AACH","ignoreList":[]}