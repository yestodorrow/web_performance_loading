{"version":3,"file":"viewContexts.js","names":["SESSION_TIME_OUT_DELAY","ContextHistory","LifeCycleEventType","VIEW_CONTEXT_TIME_OUT_DELAY","startViewContexts","lifeCycle","viewContextHistory","subscribe","BEFORE_VIEW_CREATED","view","add","buildViewContext","startClocks","relative","AFTER_VIEW_ENDED","data","closeActive","endClocks","SESSION_RENEWED","reset","service","version","id","name","findView","startTime","find","stop"],"sources":["../../../src/domain/contexts/viewContexts.js"],"sourcesContent":["import {\n  SESSION_TIME_OUT_DELAY,\n  ContextHistory,\n  LifeCycleEventType\n} from '@cloudcare/browser-core'\n\nexport var VIEW_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY\n\nexport function startViewContexts(lifeCycle) {\n  var viewContextHistory = new ContextHistory(VIEW_CONTEXT_TIME_OUT_DELAY)\n\n  lifeCycle.subscribe(LifeCycleEventType.BEFORE_VIEW_CREATED, function (view) {\n    viewContextHistory.add(buildViewContext(view), view.startClocks.relative)\n  })\n\n  lifeCycle.subscribe(LifeCycleEventType.AFTER_VIEW_ENDED, function (data) {\n    viewContextHistory.closeActive(data.endClocks.relative)\n  })\n\n  lifeCycle.subscribe(LifeCycleEventType.SESSION_RENEWED, function () {\n    viewContextHistory.reset()\n  })\n\n  function buildViewContext(view) {\n    return {\n      service: view.service,\n      version: view.version,\n      id: view.id,\n      name: view.name\n    }\n  }\n\n  return {\n    findView: function (startTime) {\n      return viewContextHistory.find(startTime)\n    },\n    stop: function () {\n      viewContextHistory.stop()\n    }\n  }\n}\n"],"mappings":"AAAA,SACEA,sBAAsB,EACtBC,cAAc,EACdC,kBAAkB,QACb,yBAAyB;AAEhC,OAAO,IAAIC,2BAA2B,GAAGH,sBAAsB;AAE/D,OAAO,SAASI,iBAAiBA,CAACC,SAAS,EAAE;EAC3C,IAAIC,kBAAkB,GAAG,IAAIL,cAAc,CAACE,2BAA2B,CAAC;EAExEE,SAAS,CAACE,SAAS,CAACL,kBAAkB,CAACM,mBAAmB,EAAE,UAAUC,IAAI,EAAE;IAC1EH,kBAAkB,CAACI,GAAG,CAACC,gBAAgB,CAACF,IAAI,CAAC,EAAEA,IAAI,CAACG,WAAW,CAACC,QAAQ,CAAC;EAC3E,CAAC,CAAC;EAEFR,SAAS,CAACE,SAAS,CAACL,kBAAkB,CAACY,gBAAgB,EAAE,UAAUC,IAAI,EAAE;IACvET,kBAAkB,CAACU,WAAW,CAACD,IAAI,CAACE,SAAS,CAACJ,QAAQ,CAAC;EACzD,CAAC,CAAC;EAEFR,SAAS,CAACE,SAAS,CAACL,kBAAkB,CAACgB,eAAe,EAAE,YAAY;IAClEZ,kBAAkB,CAACa,KAAK,CAAC,CAAC;EAC5B,CAAC,CAAC;EAEF,SAASR,gBAAgBA,CAACF,IAAI,EAAE;IAC9B,OAAO;MACLW,OAAO,EAAEX,IAAI,CAACW,OAAO;MACrBC,OAAO,EAAEZ,IAAI,CAACY,OAAO;MACrBC,EAAE,EAAEb,IAAI,CAACa,EAAE;MACXC,IAAI,EAAEd,IAAI,CAACc;IACb,CAAC;EACH;EAEA,OAAO;IACLC,QAAQ,EAAE,SAAAA,SAAUC,SAAS,EAAE;MAC7B,OAAOnB,kBAAkB,CAACoB,IAAI,CAACD,SAAS,CAAC;IAC3C,CAAC;IACDE,IAAI,EAAE,SAAAA,KAAA,EAAY;MAChBrB,kBAAkB,CAACqB,IAAI,CAAC,CAAC;IAC3B;EACF,CAAC;AACH","ignoreList":[]}