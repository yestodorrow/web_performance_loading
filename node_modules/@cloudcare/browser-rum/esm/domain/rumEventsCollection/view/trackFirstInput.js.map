{"version":3,"file":"trackFirstInput.js","names":["elapsed","find","LifeCycleEventType","isElementNode","getSelectorFromElement","trackFirstInput","lifeCycle","configuration","firstHidden","callback","subscribe","PERFORMANCE_ENTRIES_COLLECTED","entries","firstInputEntry","entry","entryType","startTime","geTimeStamp","firstInputDelay","processingStart","firstInputTargetSelector","target","actionNameAttribute","delay","time","targetSelector","stop","unsubscribe"],"sources":["../../../../src/domain/rumEventsCollection/view/trackFirstInput.js"],"sourcesContent":["import {\n  elapsed,\n  find,\n  LifeCycleEventType,\n  isElementNode\n} from '@cloudcare/browser-core'\nimport { getSelectorFromElement } from '../actions/getSelectorsFromElement'\n\n/**\n * Track the first input occurring during the initial View to return:\n * - First Input Delay\n * - First Input Time\n * Callback is called at most one time.\n * Documentation: https://web.dev/fid/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/getFID.ts\n */\nexport function trackFirstInput(\n  lifeCycle,\n  configuration,\n  firstHidden,\n  callback\n) {\n  var subscribe = lifeCycle.subscribe(\n    LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED,\n    function (entries) {\n      var firstInputEntry = find(entries, function (entry) {\n        return (\n          entry.entryType === 'first-input' &&\n          entry.startTime < firstHidden.geTimeStamp()\n        )\n      })\n      if (firstInputEntry) {\n        var firstInputDelay = elapsed(\n          firstInputEntry.startTime,\n          firstInputEntry.processingStart\n        )\n        var firstInputTargetSelector\n        if (firstInputEntry.target && isElementNode(firstInputEntry.target)) {\n          firstInputTargetSelector = getSelectorFromElement(\n            firstInputEntry.target,\n            configuration.actionNameAttribute\n          )\n        }\n        callback({\n          // Ensure firstInputDelay to be positive, see\n          // https://bugs.chromium.org/p/chromium/issues/detail?id=1185815\n          delay: firstInputDelay >= 0 ? firstInputDelay : 0,\n          time: firstInputEntry.startTime,\n          targetSelector: firstInputTargetSelector\n        })\n      }\n    }\n  )\n  return {\n    stop: subscribe.unsubscribe\n  }\n}\n"],"mappings":"AAAA,SACEA,OAAO,EACPC,IAAI,EACJC,kBAAkB,EAClBC,aAAa,QACR,yBAAyB;AAChC,SAASC,sBAAsB,QAAQ,oCAAoC;;AAE3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,eAAeA,CAC7BC,SAAS,EACTC,aAAa,EACbC,WAAW,EACXC,QAAQ,EACR;EACA,IAAIC,SAAS,GAAGJ,SAAS,CAACI,SAAS,CACjCR,kBAAkB,CAACS,6BAA6B,EAChD,UAAUC,OAAO,EAAE;IACjB,IAAIC,eAAe,GAAGZ,IAAI,CAACW,OAAO,EAAE,UAAUE,KAAK,EAAE;MACnD,OACEA,KAAK,CAACC,SAAS,KAAK,aAAa,IACjCD,KAAK,CAACE,SAAS,GAAGR,WAAW,CAACS,WAAW,CAAC,CAAC;IAE/C,CAAC,CAAC;IACF,IAAIJ,eAAe,EAAE;MACnB,IAAIK,eAAe,GAAGlB,OAAO,CAC3Ba,eAAe,CAACG,SAAS,EACzBH,eAAe,CAACM,eAClB,CAAC;MACD,IAAIC,wBAAwB;MAC5B,IAAIP,eAAe,CAACQ,MAAM,IAAIlB,aAAa,CAACU,eAAe,CAACQ,MAAM,CAAC,EAAE;QACnED,wBAAwB,GAAGhB,sBAAsB,CAC/CS,eAAe,CAACQ,MAAM,EACtBd,aAAa,CAACe,mBAChB,CAAC;MACH;MACAb,QAAQ,CAAC;QACP;QACA;QACAc,KAAK,EAAEL,eAAe,IAAI,CAAC,GAAGA,eAAe,GAAG,CAAC;QACjDM,IAAI,EAAEX,eAAe,CAACG,SAAS;QAC/BS,cAAc,EAAEL;MAClB,CAAC,CAAC;IACJ;EACF,CACF,CAAC;EACD,OAAO;IACLM,IAAI,EAAEhB,SAAS,CAACiB;EAClB,CAAC;AACH","ignoreList":[]}