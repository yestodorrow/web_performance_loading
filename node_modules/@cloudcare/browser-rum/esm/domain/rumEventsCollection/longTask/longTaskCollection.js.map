{"version":3,"file":"longTaskCollection.js","names":["toServerDuration","relativeToClocks","RumEventType","LifeCycleEventType","UUID","startLongTaskCollection","lifeCycle","sessionManager","subscribe","PERFORMANCE_ENTRIES_COLLECTED","entries","i","length","entry","entryType","session","findTrackedSession","startTime","startClocks","rawRumEvent","date","timeStamp","long_task","id","duration","type","LONG_TASK","notify","RAW_RUM_EVENT_COLLECTED","relative","domainContext","performanceEntry","toJSON"],"sources":["../../../../src/domain/rumEventsCollection/longTask/longTaskCollection.js"],"sourcesContent":["import {\n  toServerDuration,\n  relativeToClocks,\n  RumEventType,\n  LifeCycleEventType,\n  UUID\n} from '@cloudcare/browser-core'\nexport function startLongTaskCollection(lifeCycle, sessionManager) {\n  lifeCycle.subscribe(\n    LifeCycleEventType.PERFORMANCE_ENTRIES_COLLECTED,\n    function (entries) {\n      for (var i = 0; i < entries.length; i++) {\n        var entry = entries[i]\n        if (entry.entryType !== 'longtask') {\n          return\n        }\n        var session = sessionManager.findTrackedSession(entry.startTime)\n        if (!session) {\n          break\n        }\n\n        var startClocks = relativeToClocks(entry.startTime)\n        var rawRumEvent = {\n          date: startClocks.timeStamp,\n          long_task: {\n            id: UUID(),\n            duration: toServerDuration(entry.duration)\n          },\n          type: RumEventType.LONG_TASK\n        }\n        lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, {\n          rawRumEvent: rawRumEvent,\n          startTime: startClocks.relative,\n          domainContext: { performanceEntry: entry.toJSON() }\n        })\n      }\n    }\n  )\n}\n"],"mappings":"AAAA,SACEA,gBAAgB,EAChBC,gBAAgB,EAChBC,YAAY,EACZC,kBAAkB,EAClBC,IAAI,QACC,yBAAyB;AAChC,OAAO,SAASC,uBAAuBA,CAACC,SAAS,EAAEC,cAAc,EAAE;EACjED,SAAS,CAACE,SAAS,CACjBL,kBAAkB,CAACM,6BAA6B,EAChD,UAAUC,OAAO,EAAE;IACjB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,OAAO,CAACE,MAAM,EAAED,CAAC,EAAE,EAAE;MACvC,IAAIE,KAAK,GAAGH,OAAO,CAACC,CAAC,CAAC;MACtB,IAAIE,KAAK,CAACC,SAAS,KAAK,UAAU,EAAE;QAClC;MACF;MACA,IAAIC,OAAO,GAAGR,cAAc,CAACS,kBAAkB,CAACH,KAAK,CAACI,SAAS,CAAC;MAChE,IAAI,CAACF,OAAO,EAAE;QACZ;MACF;MAEA,IAAIG,WAAW,GAAGjB,gBAAgB,CAACY,KAAK,CAACI,SAAS,CAAC;MACnD,IAAIE,WAAW,GAAG;QAChBC,IAAI,EAAEF,WAAW,CAACG,SAAS;QAC3BC,SAAS,EAAE;UACTC,EAAE,EAAEnB,IAAI,CAAC,CAAC;UACVoB,QAAQ,EAAExB,gBAAgB,CAACa,KAAK,CAACW,QAAQ;QAC3C,CAAC;QACDC,IAAI,EAAEvB,YAAY,CAACwB;MACrB,CAAC;MACDpB,SAAS,CAACqB,MAAM,CAACxB,kBAAkB,CAACyB,uBAAuB,EAAE;QAC3DT,WAAW,EAAEA,WAAW;QACxBF,SAAS,EAAEC,WAAW,CAACW,QAAQ;QAC/BC,aAAa,EAAE;UAAEC,gBAAgB,EAAElB,KAAK,CAACmB,MAAM,CAAC;QAAE;MACpD,CAAC,CAAC;IACJ;EACF,CACF,CAAC;AACH","ignoreList":[]}