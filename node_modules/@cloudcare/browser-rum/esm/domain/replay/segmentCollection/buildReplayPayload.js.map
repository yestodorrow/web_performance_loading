{"version":3,"file":"buildReplayPayload.js","names":["objectEntries","each","buildReplayPayload","data","metadata","rawSegmentBytesCount","formData","FormData","append","Blob","type","session","id","start","toFormEntries","key","value","bytesCount","byteLength","input","onEntry","prefix","undefined","item","_typeof","String"],"sources":["../../../../src/domain/replay/segmentCollection/buildReplayPayload.js"],"sourcesContent":["import { objectEntries, each } from '@cloudcare/browser-core'\n\nexport function buildReplayPayload(data, metadata, rawSegmentBytesCount) {\n  var formData = new FormData()\n  formData.append(\n    'segment',\n    new Blob([data], {\n      type: 'application/octet-stream'\n    }),\n    metadata.session.id + '-' + metadata.start\n  )\n\n  toFormEntries(metadata, function (key, value) {\n    formData.append(key, value)\n  })\n  formData.append('raw_segment_size', rawSegmentBytesCount)\n\n  return { data: formData, bytesCount: data.byteLength }\n}\n\nexport function toFormEntries(input, onEntry, prefix) {\n  if (prefix === undefined) {\n    prefix = ''\n  }\n  each(objectEntries(input), function (item) {\n    var value = item[1]\n    var key = item[0]\n    if (typeof value === 'object' && value !== null) {\n      toFormEntries(value, onEntry, '' + prefix + key + '_')\n    } else {\n      onEntry('' + prefix + key, String(value))\n    }\n  })\n}\n"],"mappings":";AAAA,SAASA,aAAa,EAAEC,IAAI,QAAQ,yBAAyB;AAE7D,OAAO,SAASC,kBAAkBA,CAACC,IAAI,EAAEC,QAAQ,EAAEC,oBAAoB,EAAE;EACvE,IAAIC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;EAC7BD,QAAQ,CAACE,MAAM,CACb,SAAS,EACT,IAAIC,IAAI,CAAC,CAACN,IAAI,CAAC,EAAE;IACfO,IAAI,EAAE;EACR,CAAC,CAAC,EACFN,QAAQ,CAACO,OAAO,CAACC,EAAE,GAAG,GAAG,GAAGR,QAAQ,CAACS,KACvC,CAAC;EAEDC,aAAa,CAACV,QAAQ,EAAE,UAAUW,GAAG,EAAEC,KAAK,EAAE;IAC5CV,QAAQ,CAACE,MAAM,CAACO,GAAG,EAAEC,KAAK,CAAC;EAC7B,CAAC,CAAC;EACFV,QAAQ,CAACE,MAAM,CAAC,kBAAkB,EAAEH,oBAAoB,CAAC;EAEzD,OAAO;IAAEF,IAAI,EAAEG,QAAQ;IAAEW,UAAU,EAAEd,IAAI,CAACe;EAAW,CAAC;AACxD;AAEA,OAAO,SAASJ,aAAaA,CAACK,KAAK,EAAEC,OAAO,EAAEC,MAAM,EAAE;EACpD,IAAIA,MAAM,KAAKC,SAAS,EAAE;IACxBD,MAAM,GAAG,EAAE;EACb;EACApB,IAAI,CAACD,aAAa,CAACmB,KAAK,CAAC,EAAE,UAAUI,IAAI,EAAE;IACzC,IAAIP,KAAK,GAAGO,IAAI,CAAC,CAAC,CAAC;IACnB,IAAIR,GAAG,GAAGQ,IAAI,CAAC,CAAC,CAAC;IACjB,IAAIC,OAAA,CAAOR,KAAK,MAAK,QAAQ,IAAIA,KAAK,KAAK,IAAI,EAAE;MAC/CF,aAAa,CAACE,KAAK,EAAEI,OAAO,EAAE,EAAE,GAAGC,MAAM,GAAGN,GAAG,GAAG,GAAG,CAAC;IACxD,CAAC,MAAM;MACLK,OAAO,CAAC,EAAE,GAAGC,MAAM,GAAGN,GAAG,EAAEU,MAAM,CAACT,KAAK,CAAC,CAAC;IAC3C;EACF,CAAC,CAAC;AACJ","ignoreList":[]}