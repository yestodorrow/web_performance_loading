{"version":3,"file":"serializationUtils.js","names":["getParentNode","isNodeShadowRoot","buildUrl","isSafari","CENSORED_STRING_MARK","shouldMaskNode","serializedNodeIds","WeakMap","hasSerializedNode","node","has","nodeAndAncestorsHaveSerializedNode","current","getSerializedNodeId","get","setSerializedNodeId","serializeNodeId","set","getElementInputValue","element","nodePrivacyLevel","tagName","value","type","extractOrigin","url","origin","indexOf","split","slice","join","URL_IN_CSS_REF","ABSOLUTE_URL","DATA_URI","fixBrowserCompatibilityIssuesInCSS","cssText","includes","replace","getHref","a","document","createElement","href","switchToAbsoluteUrl","cssHref","matchingSubstring","singleQuote","urlWrappedInSingleQuotes","doubleQuote","urlWrappedInDoubleQuotes","urlNotWrappedInQuotes","test","quote","concat","makeUrlAbsolute","getCssRulesString","cssStyleSheet","rules","cssRules","_unused","styleSheetCssText","Array","from","getCssRuleStringForSafari","getCssRuleString","isCSSImportRule","rule","isSVGElement","el","SVGElement","styleSheet","baseUrl","_","isCSSStyleRule","selectorText","escapeColon","serializeStyleSheets","cssStyleSheets","undefined","length","map","cssRule","disabled","media","absoluteToDoc","doc","attributeValue","trim","SRCSET_NOT_SPACES","SRCSET_COMMAS_OR_SPACES","getAbsoluteSrcsetString","pos","collectCharacters","regEx","chars","match","exec","substring","output","push","descriptorsStr","inParens","c","charAt"],"sources":["../../../../src/domain/replay/record/serializationUtils.js"],"sourcesContent":["import {\n  getParentNode,\n  isNodeShadowRoot,\n  buildUrl,\n  isSafari\n} from '@cloudcare/browser-core'\nimport { CENSORED_STRING_MARK } from '../../../constants'\nimport { shouldMaskNode } from './privacy'\n\nvar serializedNodeIds = new WeakMap()\n\nexport function hasSerializedNode(node) {\n  return serializedNodeIds.has(node)\n}\n\nexport function nodeAndAncestorsHaveSerializedNode(node) {\n  var current = node\n  while (current) {\n    if (!hasSerializedNode(current) && !isNodeShadowRoot(current)) {\n      return false\n    }\n    current = getParentNode(current)\n  }\n  return true\n}\n\nexport function getSerializedNodeId(node) {\n  return serializedNodeIds.get(node)\n}\n\nexport function setSerializedNodeId(node, serializeNodeId) {\n  serializedNodeIds.set(node, serializeNodeId)\n}\n\n/**\n * Get the element \"value\" to be serialized as an attribute or an input update record. It respects\n * the input privacy mode of the element.\n * PERFROMANCE OPTIMIZATION: Assumes that privacy level `HIDDEN` is never encountered because of earlier checks.\n */\nexport function getElementInputValue(element, nodePrivacyLevel) {\n  /*\n   BROWSER SPEC NOTE: <input>, <select>\n   For some <input> elements, the `value` is an exceptional property/attribute that has the\n   value synced between el.value and el.getAttribute()\n   input[type=button,checkbox,hidden,image,radio,reset,submit]\n   */\n  var tagName = element.tagName\n  var value = element.value\n  if (shouldMaskNode(element, nodePrivacyLevel)) {\n    var type = element.type\n    if (\n      tagName === 'INPUT' &&\n      (type === 'button' ||\n        type === 'submit' ||\n        type === 'reset' ||\n        type === 'range')\n    ) {\n      // Overrule `MASK` privacy level for button-like element values, as they are used during replay\n      // to display their label. They can still be hidden via the \"hidden\" privacy attribute or class name.\n      return value\n    } else if (!value || tagName === 'OPTION') {\n      // <Option> value provides no benefit\n      return\n    }\n    return CENSORED_STRING_MARK\n  }\n\n  if (tagName === 'OPTION' || tagName === 'SELECT') {\n    return element.value\n  }\n\n  if (tagName !== 'INPUT' && tagName !== 'TEXTAREA') {\n    return\n  }\n\n  return value\n}\nfunction extractOrigin(url) {\n  var origin = ''\n  if (url.indexOf('//') > -1) {\n    origin = url.split('/').slice(0, 3).join('/')\n  } else {\n    origin = url.split('/')[0]\n  }\n  origin = origin.split('?')[0]\n  return origin\n}\nexport var URL_IN_CSS_REF = /url\\((?:(')([^']*)'|(\")([^\"]*)\"|([^)]*))\\)/gm\nexport var ABSOLUTE_URL = /^[A-Za-z]+:|^\\/\\//\nexport var DATA_URI = /^data:.*,/i\n/**\n * Browsers sometimes destructively modify the css rules they receive.\n * This function tries to rectify the modifications the browser made to make it more cross platform compatible.\n * @param cssText - output of `CSSStyleRule.cssText`\n * @returns `cssText` with browser inconsistencies fixed.\n */\nexport function fixBrowserCompatibilityIssuesInCSS(cssText) {\n  /**\n   * Chrome outputs `-webkit-background-clip` as `background-clip` in `CSSStyleRule.cssText`.\n   * But then Chrome ignores `background-clip` as css input.\n   * Re-introduce `-webkit-background-clip` to fix this issue.\n   */\n  if (\n    cssText.includes(' background-clip: text;') &&\n    !cssText.includes(' -webkit-background-clip: text;')\n  ) {\n    cssText = cssText.replace(\n      ' background-clip: text;',\n      ' -webkit-background-clip: text; background-clip: text;'\n    )\n  }\n  return cssText\n}\nexport function getHref() {\n  var a = document.createElement('a')\n  a.href = ''\n  return a.href\n}\nexport function switchToAbsoluteUrl(cssText, cssHref) {\n  return cssText.replace(\n    URL_IN_CSS_REF,\n    function (\n      matchingSubstring,\n      singleQuote,\n      urlWrappedInSingleQuotes,\n      doubleQuote,\n      urlWrappedInDoubleQuotes,\n      urlNotWrappedInQuotes\n    ) {\n      var url =\n        urlWrappedInSingleQuotes ||\n        urlWrappedInDoubleQuotes ||\n        urlNotWrappedInQuotes\n\n      if (!cssHref || !url || ABSOLUTE_URL.test(url) || DATA_URI.test(url)) {\n        return matchingSubstring\n      }\n      var quote = singleQuote || doubleQuote || ''\n      if (url[0] === '/') {\n        return 'url('\n          .concat(quote)\n          .concat(extractOrigin(cssHref) + url)\n          .concat(quote, ')')\n      }\n      return `url(${quote}${makeUrlAbsolute(url, cssHref)}${quote})`\n    }\n  )\n}\nexport function getCssRulesString(cssStyleSheet) {\n  if (!cssStyleSheet) {\n    return null\n  }\n  var rules\n  try {\n    rules = cssStyleSheet.rules || cssStyleSheet.cssRules\n  } catch {\n    // if css is protected by CORS we cannot access cssRules see: https://www.w3.org/TR/cssom-1/#the-cssstylesheet-interface\n  }\n  if (!rules) {\n    return null\n  }\n  var styleSheetCssText = fixBrowserCompatibilityIssuesInCSS(\n    Array.from(\n      rules,\n      isSafari() ? getCssRuleStringForSafari : getCssRuleString\n    ).join('')\n  )\n  return switchToAbsoluteUrl(styleSheetCssText, cssStyleSheet.href)\n}\nexport function isCSSImportRule(rule) {\n  return 'styleSheet' in rule\n}\n\nexport function isSVGElement(el) {\n  return el.tagName === 'svg' || el instanceof SVGElement\n}\nexport function getCssRuleString(rule) {\n  return (\n    (isCSSImportRule(rule) && getCssRulesString(rule.styleSheet)) ||\n    rule.cssText\n  )\n}\nexport function makeUrlAbsolute(url, baseUrl) {\n  try {\n    return buildUrl(url, baseUrl).href\n  } catch (_) {\n    return url\n  }\n}\nfunction isCSSStyleRule(rule) {\n  return 'selectorText' in rule\n}\nfunction getCssRuleStringForSafari(rule) {\n  // Safari does not escape attribute selectors containing : properly\n  // https://bugs.webkit.org/show_bug.cgi?id=184604\n  if (isCSSStyleRule(rule) && rule.selectorText.includes(':')) {\n    // This regex replaces [foo:bar] by [foo\\\\:bar]\n    const escapeColon = /(\\[[\\w-]+[^\\\\])(:[^\\]]+\\])/g\n    return rule.cssText.replace(escapeColon, '$1\\\\$2')\n  }\n\n  return getCssRuleString(rule)\n}\n\nexport function serializeStyleSheets(cssStyleSheets) {\n  if (cssStyleSheets === undefined || cssStyleSheets.length === 0) {\n    return undefined\n  }\n  return cssStyleSheets.map(function (cssStyleSheet) {\n    var rules = cssStyleSheet.cssRules || cssStyleSheet.rules\n    var cssRules = Array.from(rules, function (cssRule) {\n      return cssRule.cssText\n    })\n\n    var styleSheet = {\n      cssRules: cssRules,\n      disabled: cssStyleSheet.disabled || undefined,\n      media:\n        cssStyleSheet.media.length > 0\n          ? Array.from(cssStyleSheet.media)\n          : undefined\n    }\n    return styleSheet\n  })\n}\nexport function absoluteToDoc(doc, attributeValue) {\n  if (!attributeValue || attributeValue.trim() === '') {\n    return attributeValue\n  }\n  var a = doc.createElement('a')\n  a.href = attributeValue\n  return a.href\n}\n\nvar SRCSET_NOT_SPACES = /^[^ \\t\\n\\r\\u000c]+/\nvar SRCSET_COMMAS_OR_SPACES = /^[, \\t\\n\\r\\u000c]+/\nexport function getAbsoluteSrcsetString(doc, attributeValue) {\n  if (attributeValue.trim() === '') {\n    return attributeValue\n  }\n  var pos = 0\n  function collectCharacters(regEx) {\n    var chars\n    var match = regEx.exec(attributeValue.substring(pos))\n    if (match) {\n      chars = match[0]\n      pos += chars.length\n      return chars\n    }\n    return ''\n  }\n  var output = []\n  while (true) {\n    collectCharacters(SRCSET_COMMAS_OR_SPACES)\n    if (pos >= attributeValue.length) {\n      break\n    }\n    var url = collectCharacters(SRCSET_NOT_SPACES)\n    if (url.slice(-1) === ',') {\n      url = absoluteToDoc(doc, url.substring(0, url.length - 1))\n      output.push(url)\n    } else {\n      var descriptorsStr = ''\n      url = absoluteToDoc(doc, url)\n      var inParens = false\n      while (true) {\n        var c = attributeValue.charAt(pos)\n        if (c === '') {\n          output.push((url + descriptorsStr).trim())\n          break\n        } else if (!inParens) {\n          if (c === ',') {\n            pos += 1\n            output.push((url + descriptorsStr).trim())\n            break\n          } else if (c === '(') {\n            inParens = true\n          }\n        } else {\n          if (c === ')') {\n            inParens = false\n          }\n        }\n        descriptorsStr += c\n        pos += 1\n      }\n    }\n  }\n  return output.join(', ')\n}\n"],"mappings":"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","ignoreList":[]}