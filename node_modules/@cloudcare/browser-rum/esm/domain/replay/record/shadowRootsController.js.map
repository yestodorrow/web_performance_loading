{"version":3,"file":"shadowRootsController.js","names":["startMutationObserver","initInputObserver","initShadowRootsController","configuration","data","mutationCb","inputCb","controllerByShadowRoot","Map","shadowRootsController","addShadowRoot","shadowRoot","has","_startMutaionObserve","flush","stopMutationObserver","stop","stopInputObserver","defaultPrivacyLevel","set","removeShadowRoot","entry","get","forEach","event"],"sources":["../../../../src/domain/replay/record/shadowRootsController.js"],"sourcesContent":["import { startMutationObserver } from './mutationObserver'\nimport { initInputObserver } from './observers'\n\nexport var initShadowRootsController = function (configuration, data) {\n  var mutationCb = data.mutationCb\n  var inputCb = data.inputCb\n  var controllerByShadowRoot = new Map()\n\n  var shadowRootsController = {\n    addShadowRoot: function (shadowRoot) {\n      if (controllerByShadowRoot.has(shadowRoot)) {\n        return\n      }\n      var _startMutaionObserve = startMutationObserver(\n        mutationCb,\n        configuration,\n        shadowRootsController,\n        shadowRoot\n      )\n      var flush = _startMutaionObserve.flush\n      var stopMutationObserver = _startMutaionObserve.stop\n\n      // the change event no do bubble up across the shadow root, we have to listen on the shadow root\n      var stopInputObserver = initInputObserver(\n        inputCb,\n        configuration.defaultPrivacyLevel,\n        shadowRoot\n      )\n      controllerByShadowRoot.set(shadowRoot, {\n        flush: flush,\n        stop: function () {\n          stopMutationObserver()\n          stopInputObserver()\n        }\n      })\n    },\n    removeShadowRoot: function (shadowRoot) {\n      var entry = controllerByShadowRoot.get(shadowRoot)\n      if (!entry) {\n        return\n      }\n      entry.stop()\n      controllerByShadowRoot.delete(shadowRoot)\n    },\n    stop: function () {\n      controllerByShadowRoot.forEach(function (event) {\n        event.stop()\n      })\n    },\n    flush: function () {\n      controllerByShadowRoot.forEach(function (event) {\n        event.flush()\n      })\n    }\n  }\n  return shadowRootsController\n}\n"],"mappings":"AAAA,SAASA,qBAAqB,QAAQ,oBAAoB;AAC1D,SAASC,iBAAiB,QAAQ,aAAa;AAE/C,OAAO,IAAIC,yBAAyB,GAAG,SAA5BA,yBAAyBA,CAAaC,aAAa,EAAEC,IAAI,EAAE;EACpE,IAAIC,UAAU,GAAGD,IAAI,CAACC,UAAU;EAChC,IAAIC,OAAO,GAAGF,IAAI,CAACE,OAAO;EAC1B,IAAIC,sBAAsB,GAAG,IAAIC,GAAG,CAAC,CAAC;EAEtC,IAAIC,qBAAqB,GAAG;IAC1BC,aAAa,EAAE,SAAAA,cAAUC,UAAU,EAAE;MACnC,IAAIJ,sBAAsB,CAACK,GAAG,CAACD,UAAU,CAAC,EAAE;QAC1C;MACF;MACA,IAAIE,oBAAoB,GAAGb,qBAAqB,CAC9CK,UAAU,EACVF,aAAa,EACbM,qBAAqB,EACrBE,UACF,CAAC;MACD,IAAIG,KAAK,GAAGD,oBAAoB,CAACC,KAAK;MACtC,IAAIC,oBAAoB,GAAGF,oBAAoB,CAACG,IAAI;;MAEpD;MACA,IAAIC,iBAAiB,GAAGhB,iBAAiB,CACvCK,OAAO,EACPH,aAAa,CAACe,mBAAmB,EACjCP,UACF,CAAC;MACDJ,sBAAsB,CAACY,GAAG,CAACR,UAAU,EAAE;QACrCG,KAAK,EAAEA,KAAK;QACZE,IAAI,EAAE,SAAAA,KAAA,EAAY;UAChBD,oBAAoB,CAAC,CAAC;UACtBE,iBAAiB,CAAC,CAAC;QACrB;MACF,CAAC,CAAC;IACJ,CAAC;IACDG,gBAAgB,EAAE,SAAAA,iBAAUT,UAAU,EAAE;MACtC,IAAIU,KAAK,GAAGd,sBAAsB,CAACe,GAAG,CAACX,UAAU,CAAC;MAClD,IAAI,CAACU,KAAK,EAAE;QACV;MACF;MACAA,KAAK,CAACL,IAAI,CAAC,CAAC;MACZT,sBAAsB,UAAO,CAACI,UAAU,CAAC;IAC3C,CAAC;IACDK,IAAI,EAAE,SAAAA,KAAA,EAAY;MAChBT,sBAAsB,CAACgB,OAAO,CAAC,UAAUC,KAAK,EAAE;QAC9CA,KAAK,CAACR,IAAI,CAAC,CAAC;MACd,CAAC,CAAC;IACJ,CAAC;IACDF,KAAK,EAAE,SAAAA,MAAA,EAAY;MACjBP,sBAAsB,CAACgB,OAAO,CAAC,UAAUC,KAAK,EAAE;QAC9CA,KAAK,CAACV,KAAK,CAAC,CAAC;MACf,CAAC,CAAC;IACJ;EACF,CAAC;EACD,OAAOL,qBAAqB;AAC9B,CAAC","ignoreList":[]}